(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f74e"],{CPU5:function(e,t,r){"use strict";var o=r("VCFd");r.n(o).a},DKYH:function(e,t,r){"use strict";r.d(t,"f",function(){return i}),r.d(t,"j",function(){return n}),r.d(t,"b",function(){return a}),r.d(t,"d",function(){return s}),r.d(t,"g",function(){return l}),r.d(t,"h",function(){return c}),r.d(t,"a",function(){return u}),r.d(t,"c",function(){return d}),r.d(t,"i",function(){return f}),r.d(t,"e",function(){return h});var o=r("t3Un");function i(e){return Object(o.a)({url:"/sys/business/shopInfo/getShopConfigInfo?shopId="+e,method:"get"})}function n(e){return Object(o.a)({url:"/sys/business/shopInfo/updateShopConfigInfo",method:"post",data:e})}function a(){return Object(o.a)({url:"/product/business/freightTemplate/getFreightSystemDistrictInfo",method:"get"})}function s(e){return Object(o.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoList",method:"post",data:e})}function l(e){return Object(o.a)({url:"/product/business/freightTemplate/insertFreightTemplateInfo",method:"post",data:e})}function c(e){return Object(o.a)({url:"/product/business/freightTemplate/updateDefault",method:"post",data:e})}function u(e){return Object(o.a)({url:"/product/business/freightTemplate/deleteFreightTemplateInfo",method:"post",data:e})}function d(e){return Object(o.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoById?templateId="+e,method:"get"})}function f(e){return Object(o.a)({url:"/product/business/freightTemplate/updateFreightTemplateInfo",method:"post",data:e})}function h(e){return Object(o.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoListNotPage?shopId="+e,method:"get"})}},PHgE:function(e,t,r){"use strict";r.r(t);var o=r("QbLZ"),i=r.n(o),n=r("DKYH"),a=r("L2JU"),s={data:function(){return{showSend:!1,treeData:[],defaultProps:{children:"children",label:"name"},diaIndex:0,diaType:"",ruleForm:{},tableData:[{firstPiece:"1",firstFreightPrice:"0.00",addPiece:"1",addFreightPrice:"0.00",distributionAreaName:"全部地区可配送",handle:!1,checked:!0,type:!0}],rules:{templateName:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},addLoading:!1}},created:function(){this.getTree()},methods:{treeSub:function(){var e=this.$refs.tree.getCheckedNodes();if(e=e.filter(function(e){return 0==e.disabled}),console.log("data过滤已选中",e),0!=e.length){var t=[];e.forEach(function(e){if(e.disabled=!0,2==e.level){var r=t.find(function(t){return t.code==e.parentCode});if(console.log(r),r)r.children.push(e);else{var o=[];o.push(e);var i={code:e.parentCode,children:o,name:e.parentName};t.push(i)}}}),console.log("arr1",t);var r=[];t.forEach(function(e){e.children.length==e.children[0].parentLenth?r.push(e.name):e.children.forEach(function(e){r.push(e.name)})}),console.log("nameStr",r),r=r.join(" , "),console.log("nameStr",r);"edit"==this.diaType&&(this.tableData.splice(this.diaIndex,1),this.diaType="");var o={handle:!0};o.freightTemplateCityDtoList=e.filter(function(e){return 2==e.level}),o.distributionAreaName=r,o.firstPiece="1",o.firstFreightPrice="0.00",o.addPiece="1",o.addFreightPrice="0.00",o.checked=!0,o.areaType=1,o.selectData=e,this.showSend=!1,this.tableData.push(o)}else this.$message.error("请勾选至少一条后重试")},showSendFun:function(e,t){console.log("e",e),console.log("e1",t),"edit"==e&&(console.log(t),t.row.selectData.forEach(function(e){return e.disabled=!1}),this.diaType="edit",this.diaIndex=t.$index,this.diaObj=t),this.showSend=!0},subForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;if(t.tableData[0].checked)t.tableData[0].areaType=0,t.ruleForm.freightTemplateRuleDtoList=t.tableData;else{if(1==t.tableData.length)return void t.$message.error("请添加可配送的区域");for(var r=[],o=1;o<t.tableData.length;o++)r.push(t.tableData[o]);t.ruleForm.freightTemplateRuleDtoList=r}t.ruleForm.shopId=t.shop.shopId,t.addLoading=!0,console.log("添加模板请求的数据",t.ruleForm),Object(n.g)(t.ruleForm).then(function(e){console.log("添加模板",e),200==e.code?(t.$message({message:"创建成功",type:"success"}),setTimeout(function(){t.$router.replace({path:"/logistics/logisticsTemplate"}),t.addLoading=!1},1e3)):(t.$message.error(e.message),t.addLoading=!1)})})},closeTree:function(){"edit"==this.diaType?(console.log("修改了"),this.diaObj.row.selectData.forEach(function(e){return e.disabled=!0}),this.diaType=""):console.log("没走"),this.showSend=!1},deleteItem:function(e){console.log(e),console.log(e.$index),e.row.selectData.forEach(function(e){e.checked=!1,e.disabled=!1}),this.tableData.splice(e.$index,1)},back:function(){var e=this;this.$confirm("确定放弃编辑运费模板吗?","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.replace({path:"/logistics/logisticsTemplate"})}).catch(function(){})},getTree:function(){var e=this;Object(n.b)().then(function(t){console.log("查询树",t),e.treeData=t.data})}},computed:i()({},Object(a.c)(["user","shop"]))},l=(r("CPU5"),r("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pageContent"},[r("el-card",{staticClass:"box-card"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,stripe:"",fit:"",rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"模板名称：",prop:"templateName"}},[r("el-input",{staticStyle:{width:"400px"},model:{value:e.ruleForm.templateName,callback:function(t){e.$set(e.ruleForm,"templateName",t)},expression:"ruleForm.templateName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"计费方式："}},[r("div",[e._v("按件数")])]),e._v(" "),r("el-form-item",{attrs:{label:"配送区域："}},[r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{fit:"",data:e.tableData}},[r("el-table-column",{attrs:{label:"可配送区域","min-width":"450"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"flex-row-start"},[t.row.type?r("div",[r("el-checkbox",{staticStyle:{width:"450px"},model:{value:t.row.checked,callback:function(r){e.$set(t.row,"checked",r)},expression:"scope.row.checked"}},[e._v(e._s(t.row.distributionAreaName)+"（未勾选时,则仅下列所选地区可配送）")])],1):r("div",[e._v(e._s(t.row.distributionAreaName))])])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"首件（个）",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{size:"mini",controls:!1,disabled:!t.row.checked,min:1,max:100,step:1,"step-strictly":""},model:{value:t.row.firstPiece,callback:function(r){e.$set(t.row,"firstPiece",r)},expression:"scope.row.firstPiece"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"运费（元）",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{size:"mini",controls:!1,disabled:!t.row.checked,precision:2,min:0,max:1e3,step:.1},model:{value:t.row.firstFreightPrice,callback:function(r){e.$set(t.row,"firstFreightPrice",r)},expression:"scope.row.firstFreightPrice"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"续件（个）",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{size:"mini",controls:!1,disabled:!t.row.checked,min:1,max:100,step:1,"step-strictly":""},model:{value:t.row.addPiece,callback:function(r){e.$set(t.row,"addPiece",r)},expression:"scope.row.addPiece"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"续费（元）",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{size:"mini",controls:!1,disabled:!t.row.checked,precision:2,min:0,max:1e3,step:.1},model:{value:t.row.addFreightPrice,callback:function(r){e.$set(t.row,"addFreightPrice",r)},expression:"scope.row.addFreightPrice"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.handle?r("div",[r("el-button",{attrs:{type:"text"},on:{click:function(r){e.showSendFun("edit",t)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(r){e.deleteItem(t)}}},[e._v("删除")])],1):r("div",[e._v("-")])]}}])})],1)],1)]),e._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showSendFun("new")}}},[e._v("指定配送区域和运费")])],1),e._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{loading:e.addLoading,type:"primary"},on:{click:function(t){e.subForm("ruleForm")}}},[e._v("保 存")]),e._v(" "),r("el-button",{on:{click:e.back}},[e._v("返 回")])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"选择配送区域",visible:e.showSend,width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.showSend=t}}},[r("div",[r("el-tree",{ref:"tree",attrs:{data:e.treeData,"show-checkbox":"","node-key":"code","highlight-current":"",props:e.defaultProps}})],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.closeTree}},[e._v("关 闭")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.treeSub}},[e._v("确 定")])],1)])],1)},[],!1,null,"219516f6",null);c.options.__file="newTemplate.vue";t.default=c.exports},VCFd:function(e,t,r){}}]);
//# sourceMappingURL=chunk-f74e.46da2194.js.map