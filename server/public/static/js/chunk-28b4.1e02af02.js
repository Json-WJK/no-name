(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-28b4"],{"/UYJ":function(t,e,i){"use strict";var o=i("Fdno");i.n(o).a},"2rhy":function(t,e,i){"use strict";i.d(e,"g",function(){return s}),i.d(e,"b",function(){return a}),i.d(e,"a",function(){return l}),i.d(e,"j",function(){return r}),i.d(e,"c",function(){return n}),i.d(e,"i",function(){return c}),i.d(e,"f",function(){return u}),i.d(e,"e",function(){return d}),i.d(e,"h",function(){return m}),i.d(e,"d",function(){return f});var o=i("t3Un");function s(t){return Object(o.a)({url:"/sys/business/shopActivity/getShopActivityList",method:"post",data:t})}function a(t){return Object(o.a)({url:"/sys/business/shopActivity/calculatedActivityDiscount",method:"post",data:t})}function l(t){return Object(o.a)({url:"/sys/business/shopActivity/addShopActivity",method:"post",data:t})}function r(t){return Object(o.a)({url:"/sys/business/shopActivity/updateShopActivity",method:"post",data:t})}function n(t){return Object(o.a)({url:"/sys/business/shopActivity/deleteShopActivity",method:"post",data:t})}function c(t){return Object(o.a)({url:"/sys/business/shopActivity/invalidShopActivity",method:"post",data:t})}function u(t){return Object(o.a)({url:"/sys/business/shopActivity/getShopActivityById",method:"post",data:t})}function d(t){return Object(o.a)({url:"/sys/business/shopActivity/getActivityProductListById",method:"post",data:t})}function m(t){return Object(o.a)({url:"/sys/business/shopActivity/getShopActivityListById",method:"post",data:t})}function f(t){return Object(o.a)({url:"/product/mall/active/findActiveAndProduct?activeId="+t.activeId+"&productIds="+t.ids,method:"get"})}},"83wi":function(t,e,i){"use strict";i.r(e);var o=i("QbLZ"),s=i.n(o),a=i("L2JU"),l=i("2rhy"),r={data:function(){return{form:{calculateType:1,isShow:0,time:[]},subLoading:!1,commodityList:[],showImg:!1,showImg1:!1,commodityIds:[],commodityShow:!1,alldiscount:void 0,allstock:void 0,discountvisible:!1,stockvisible:!1}},created:function(){this.getData()},methods:{getData:function(){var t=this;Object(l.f)({id:this.$route.query.id}).then(function(e){console.log("活动详情",e),200==e.code?(t.form=e.data,t.form.time=[e.data.beginActivityTime,e.data.endActivityTime],t.commodityList=e.data.productList):t.$message.error(e.message)})},allChangediscount:function(){var t=this;console.log("this.commodityList",this.commodityList),this.commodityList[0].list.forEach(function(e){e.finallyPrice=t.alldiscount}),this.alldiscount=void 0,this.discountvisible=!1,this.change()},allChangestock:function(){var t=this;this.commodityList[0].list.forEach(function(e){e.addLockStock=t.allstock}),console.log(this.commodityList),this.allstock=void 0,this.stockvisible=!1,this.change()},subForm:function(){var t=this;if(console.log("this.form",this.form),console.log("this.commodityList",this.commodityList),this.form.name)if(0!=this.commodityList.length){var e=this.commodityList[0].list.filter(function(t){return void 0==t.finallyPrice||t.finallyPrice>=t.price});if(console.log("errArr",e),e.length>0)this.$message.error("商品列表中存在不完整或不正确的数据(砍价底价应小于售价，活动库存应小于商品库存)");else{var i=this.commodityList[0].list.filter(function(t){return t.addLockStock>t.skuStock});if(console.log("errArr1",i),i.length>0)this.$message.error("商品列表中新增活动库存需要小于等于商品库存");else if(this.form.productList=this.commodityList,this.form.helpCount)if(this.form.beginTime)if(this.form.endTime){var o=new Date(this.form.beginTime.replace(/-/g,"/")).getTime();new Date(this.form.endTime.replace(/-/g,"/")).getTime()<=o?this.$message.error("结束时间应大于开始时间"):void 0!=this.form.limitNumber?(this.subLoading=!0,this.form.shopId=this.shop.shopId,this.form.activityType=2,this.form.userId=this.user.userId,Object(l.j)(this.form).then(function(e){console.log("修改活动",e),200==e.code?(t.$message({message:e.message,type:"success"}),setTimeout(function(){t.subLoading=!1,t.$router.replace({path:"/marketManage/bargain"})},1e3)):(t.subLoading=!1,t.$message.error(e.message))})):this.$message.error("请输入活动限购数")}else this.$message.error("请设置活动结束时间");else this.$message.error("请设置活动开始时间");else this.$message.error("请输入帮砍人数")}}else this.$message.error("请添加参与活动的商品");else this.$message.error("请输入活动名称")},back:function(){var t=this;this.$confirm("确定放弃编辑?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.replace({path:"/marketManage/bargain"})}).catch(function(){})},changeItem:function(){},change:function(){this.$forceUpdate()}},computed:s()({},Object(a.c)(["user","shop"]))},n=(i("/UYJ"),i("KHd+")),c=Object(n.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pageContent"},[o("el-card",{attrs:{shadow:"always"}},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.form,"label-width":"180px"}},[o("el-form-item",{attrs:{label:"活动名称：",required:""}},[o("el-input",{staticStyle:{width:"400px"},attrs:{maxlength:"20","show-word-limit":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"==typeof e?e.trim():e)},expression:"form.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"活动商品：",required:""}},[t.commodityList.length>0?o("div",[0==t.commodityList[0].skuType?o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.commodityList,"tooltip-effect":"dark"}},[o("el-table-column",{attrs:{label:"商品名称",prop:"productName"}}),t._v(" "),o("el-table-column",{attrs:{label:"售价（元）",prop:"price",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.list[0].price?"￥"+e.row.list[0].price:"-"))]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"成本价（元）",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.list[0].costPrice?"￥"+e.row.list[0].costPrice:"-"))]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"180"},scopedSlots:t._u([{key:"header",fn:function(e){return[o("span",{attrs:{"data-scope":e}},[t._v("砍价底价（元）")]),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"售价 > 底价 >= 0",placement:"top"}},[o("i",{staticClass:"el-icon-question"})])]}},{key:"default",fn:function(e){return[t._v("\n                  ￥"),o("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:1==t.form.activityStatus,precision:2,controls:!1,min:0},model:{value:e.row.list[0].finallyPrice,callback:function(i){t.$set(e.row.list[0],"finallyPrice",i)},expression:"scope.row.list[0].finallyPrice"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"库存",prop:"skuStock",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.list[0].skuStock))]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"140"},scopedSlots:t._u([{key:"header",fn:function(e){return[o("span",{attrs:{"data-scope":e.row}},[t._v("活动库存")]),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"用户支付成功扣除活动库存，退货不增加活动库存",placement:"top-start"}},[o("i",{staticClass:"el-icon-question"})])]}},{key:"default",fn:function(e){return[t._v(t._s(e.row.list[0].lockStock))]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"增加活动库存",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-input-number",{staticStyle:{width:"100px"},attrs:{"step-strictly":"",controls:!1,min:0},model:{value:e.row.list[0].addLockStock,callback:function(i){t.$set(e.row.list[0],"addLockStock",i)},expression:"scope.row.list[0].addLockStock"}})]}}])})],1)],1):t._e(),t._v(" "),1==t.commodityList[0].skuType?o("div",[o("el-card",{attrs:{shadow:"always"}},[o("div",{staticClass:"flex-row-start"},[o("div",[t._v(t._s(t.commodityList[0].productName))])]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.commodityList[0].list,"tooltip-effect":"dark"}},[o("el-table-column",{attrs:{label:"规格",prop:"skuName"}}),t._v(" "),o("el-table-column",{attrs:{label:"售价（元）",prop:"price",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.price?"￥"+e.row.price:"-"))]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"成本价（元）",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.costPrice?"￥"+e.row.costPrice:"-"))]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"180"},scopedSlots:t._u([{key:"header",fn:function(e){return[o("span",{attrs:{"data-scope":e}},[t._v("砍价底价（元）")]),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"售价 > 底价 >= 0",placement:"top"}},[o("i",{staticClass:"el-icon-question"})])]}},{key:"default",fn:function(e){return[t._v("\n                    ￥"),o("el-input-number",{staticStyle:{width:"100px"},attrs:{disabled:1==t.form.activityStatus,controls:!1,precision:2,min:0},on:{input:function(e){t.change(e)}},model:{value:e.row.finallyPrice,callback:function(i){t.$set(e.row,"finallyPrice",i)},expression:"scope.row.finallyPrice"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"库存",prop:"skuStock",width:"140"}}),t._v(" "),o("el-table-column",{attrs:{width:"140",prop:"lockStock"},scopedSlots:t._u([{key:"header",fn:function(e){return[o("span",{attrs:{"data-scope":e.row}},[t._v("活动库存")]),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"用户支付成功扣除活动库存，退货不增加活动库存",placement:"top-start"}},[o("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"增加活动库存",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-input-number",{staticStyle:{width:"100px"},attrs:{"step-strictly":"",controls:!1,min:0},on:{input:function(e){t.change(e)}},model:{value:e.row.addLockStock,callback:function(i){t.$set(e.row,"addLockStock",i)},expression:"scope.row.addLockStock"}})]}}])})],1),t._v(" "),o("div",{staticClass:"flex-row-start",staticStyle:{"margin-top":"20px"}},[o("el-popover",{attrs:{placement:"bottom",trigger:"click"},model:{value:t.discountvisible,callback:function(e){t.discountvisible=e},expression:"discountvisible"}},[o("div",{staticClass:"flex-row-start",staticStyle:{"margin-left":"20px"}},[o("el-input-number",{staticStyle:{width:"100px"},attrs:{controls:!1,min:1},model:{value:t.alldiscount,callback:function(e){t.alldiscount=e},expression:"alldiscount"}}),t._v(" "),o("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"text"},on:{click:t.allChangediscount}},[t._v("确定")])],1),t._v(" "),o("el-button",{attrs:{slot:"reference",disabled:1==t.form.activityStatus},slot:"reference"},[t._v("砍价底价")])],1),t._v(" "),o("el-popover",{staticStyle:{"margin-left":"40px"},attrs:{placement:"bottom",trigger:"click"},model:{value:t.stockvisible,callback:function(e){t.stockvisible=e},expression:"stockvisible"}},[o("div",{staticClass:"flex-row-start",staticStyle:{"margin-left":"20px"}},[o("el-input-number",{staticStyle:{width:"100px"},attrs:{"step-strictly":"",controls:!1,min:0},model:{value:t.allstock,callback:function(e){t.allstock=e},expression:"allstock"}}),t._v(" "),o("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"text"},on:{click:t.allChangestock}},[t._v("确定")])],1),t._v(" "),o("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("增加库存")])],1)],1)],1)],1):t._e()]):t._e()]),t._v(" "),o("el-form-item",{attrs:{label:"帮砍金额：",required:""}},[o("el-radio-group",{attrs:{disabled:1==t.form.activityStatus},model:{value:t.form.calculateType,callback:function(e){t.$set(t.form,"calculateType",e)},expression:"form.calculateType"}},[o("el-radio",{attrs:{label:1}},[t._v("随机金额")]),t._v(" "),o("el-radio",{attrs:{label:2}},[t._v("固定金额")])],1),t._v(" "),o("div",{staticClass:"infoFont"},[t._v("设置每位帮砍用户的砍价金额规格。")])],1),t._v(" "),o("el-form-item",{attrs:{label:"帮砍人数：",required:""}},[o("el-input-number",{attrs:{disabled:1==t.form.activityStatus,"step-strictly":"",controls:!1,min:2,max:100,placeholder:"2~100"},model:{value:t.form.helpCount,callback:function(e){t.$set(t.form,"helpCount",e)},expression:"form.helpCount"}}),t._v(" "),o("div",{staticClass:"infoFont"},[t._v("2~100.每个砍价订单的帮砍人数，达到该人数才可砍至底价")])],1),t._v(" "),o("el-form-item",{attrs:{label:"展示人数："}},[o("el-radio-group",{attrs:{disabled:1==t.form.activityStatus},model:{value:t.form.isShow,callback:function(e){t.$set(t.form,"isShow",e)},expression:"form.isShow"}},[o("el-radio",{attrs:{label:0}},[t._v("展示")]),t._v(" "),o("el-radio",{attrs:{label:1}},[t._v("不展示")])],1),t._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(e){t.showImg1=!0}}},[t._v("查看示例")])],1),t._v(" "),o("el-form-item",{attrs:{label:"活动开始时间：",required:""}},[o("el-date-picker",{attrs:{disabled:1==t.form.activityStatus,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择开始时间"},model:{value:t.form.beginTime,callback:function(e){t.$set(t.form,"beginTime",e)},expression:"form.beginTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"活动结束时间：",required:""}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择结束时间"},model:{value:t.form.endTime,callback:function(e){t.$set(t.form,"endTime",e)},expression:"form.endTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"活动有效期："}},[o("el-input-number",{attrs:{disabled:1==t.form.activityStatus,"step-strictly":"",controls:!1,min:1,max:48,placeholder:"1~48"},model:{value:t.form.activityValidity,callback:function(e){t.$set(t.form,"activityValidity",e)},expression:"form.activityValidity"}}),t._v(" 小时\n        "),o("div",{staticClass:"infoFont"},[t._v("1~48.用户发起砍价到砍价截止的时间，不设置则按照活动结束时间进行限制。")])],1),t._v(" "),o("el-form-item",{attrs:{label:"限购数量：",required:""}},[o("el-input-number",{attrs:{disabled:1==t.form.activityStatus,"step-strictly":"",controls:!1,min:0},model:{value:t.form.limitNumber,callback:function(e){t.$set(t.form,"limitNumber",e)},expression:"form.limitNumber"}}),t._v(" "),o("div",{staticClass:"infoFont"},[t._v("限制每个用户发起砍价的次数，输入0代表不限制发起砍价次数。")])],1),t._v(" "),o("el-form-item",{attrs:{label:"分享朋友圈标题："}},[o("el-input",{staticStyle:{width:"400px"},attrs:{maxlength:"20","show-word-limit":""},model:{value:t.form.wxMomentsTitle,callback:function(e){t.$set(t.form,"wxMomentsTitle","string"==typeof e?e.trim():e)},expression:"form.wxMomentsTitle"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分享好友标题："}},[o("el-input",{staticStyle:{width:"400px"},attrs:{maxlength:"20","show-word-limit":""},model:{value:t.form.wxFriendsTitle,callback:function(e){t.$set(t.form,"wxFriendsTitle","string"==typeof e?e.trim():e)},expression:"form.wxFriendsTitle"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分享好友文案："}},[o("el-input",{staticStyle:{width:"400px"},attrs:{maxlength:"30","show-word-limit":""},model:{value:t.form.wxFriendsContent,callback:function(e){t.$set(t.form,"wxFriendsContent","string"==typeof e?e.trim():e)},expression:"form.wxFriendsContent"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分享示例："}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showImg=!0}}},[t._v("查看示例")])],1),t._v(" "),o("el-form-item",{attrs:{label:"重要提醒：",required:""}},[o("div",{staticClass:"dangerFont"},[t._v("砍价活动与所有活动互斥")])])],1)],1),t._v(" "),o("div",{staticClass:"flex-row-center",staticStyle:{"margin-top":"20px"}},[o("el-button",{on:{click:t.back}},[t._v("返 回")]),t._v(" "),o("el-button",{attrs:{loading:t.subLoading,type:"primary"},on:{click:t.subForm}},[t._v("保 存")])],1),t._v(" "),o("el-dialog",{attrs:{title:"示例",visible:t.showImg,width:"30%",center:""},on:{"update:visible":function(e){t.showImg=e}}},[o("div",{staticClass:"flex-row-center"},[o("img",{staticStyle:{"max-width":"100%"},attrs:{src:i("aLoW"),alt:""}})])]),t._v(" "),o("el-dialog",{attrs:{title:"示例",visible:t.showImg1,width:"30%",center:""},on:{"update:visible":function(e){t.showImg1=e}}},[o("div",{staticClass:"flex-row-center"},[o("img",{staticStyle:{"max-width":"100%"},attrs:{src:i("jeZS"),alt:""}})])])],1)},[],!1,null,"2e3167a5",null);c.options.__file="editBargain.vue";e.default=c.exports},Fdno:function(t,e,i){},aLoW:function(t,e,i){t.exports=i.p+"static/img/share1.0f7bb25.png"},jeZS:function(t,e,i){t.exports=i.p+"static/img/share3.9348441.png"}}]);
//# sourceMappingURL=chunk-28b4.1e02af02.js.map