(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2666","rbj7"],{DKYH:function(t,e,o){"use strict";o.d(e,"f",function(){return s}),o.d(e,"j",function(){return a}),o.d(e,"b",function(){return i}),o.d(e,"d",function(){return l}),o.d(e,"g",function(){return r}),o.d(e,"h",function(){return c}),o.d(e,"a",function(){return u}),o.d(e,"c",function(){return d}),o.d(e,"i",function(){return p}),o.d(e,"e",function(){return f});var n=o("t3Un");function s(t){return Object(n.a)({url:"/sys/business/shopInfo/getShopConfigInfo?shopId="+t,method:"get"})}function a(t){return Object(n.a)({url:"/sys/business/shopInfo/updateShopConfigInfo",method:"post",data:t})}function i(){return Object(n.a)({url:"/product/business/freightTemplate/getFreightSystemDistrictInfo",method:"get"})}function l(t){return Object(n.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoList",method:"post",data:t})}function r(t){return Object(n.a)({url:"/product/business/freightTemplate/insertFreightTemplateInfo",method:"post",data:t})}function c(t){return Object(n.a)({url:"/product/business/freightTemplate/updateDefault",method:"post",data:t})}function u(t){return Object(n.a)({url:"/product/business/freightTemplate/deleteFreightTemplateInfo",method:"post",data:t})}function d(t){return Object(n.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoById?templateId="+t,method:"get"})}function p(t){return Object(n.a)({url:"/product/business/freightTemplate/updateFreightTemplateInfo",method:"post",data:t})}function f(t){return Object(n.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoListNotPage?shopId="+t,method:"get"})}},KXTZ:function(t,e,o){"use strict";var n=o("rNa8");o.n(n).a},aSWR:function(t,e,o){"use strict";o.r(e);var n=o("QbLZ"),s=o.n(n),a=o("rbj7"),i=o("L2JU"),l=o("DKYH"),r={data:function(){return{showRules:!1,radioForm:{freightRule:"0"},radioLoading:!1,listForm:{pageNum:1,pageSize:5},listTotal:0,list:[]}},created:function(){this.radioForm.shopId=this.shop.shopId,this.listForm.shopId=this.shop.shopId,this.getStatus(),this.getData()},methods:{getData:function(){var t=this;Object(l.d)(this.listForm).then(function(e){console.log("数据列表",e),t.listTotal=e.data.total,t.list=e.data.list})},deleteItem:function(t){var e=this;0!=t.productCount?this.$alert("该模板有"+t.productCount+"个商品在使用，如需删除请先更换这些商品的运费模板","提示",{confirmButtonText:"确定",type:"warning",callback:function(t){}}):this.$confirm("删除运费模板【"+t.templateName+"】?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.a)({templateId:t.id}).then(function(t){200==t.code?(e.$message({message:"删除成功",type:"success"}),e.getData()):e.$message.error(t.message)})}).catch(function(){})},setDefault:function(t){var e=this;console.log(t),this.$confirm("将此条设置为默认模板?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(l.h)({shopId:e.shop.shopId,templateId:t.id}).then(function(t){200==t.code?(e.$message({message:"设置成功",type:"success"}),e.getData()):e.$message.error(t.message)})}).catch(function(){})},changeRadio:function(){var t=this;this.radioLoading=!0,console.log("this.radioForm",this.radioForm),Object(l.j)(this.radioForm).then(function(e){console.log("更改计费方式",e),200==e.code?(t.$message({message:"修改成功",type:"success"}),t.radioLoading=!1):(t.radioLoading=!1,t.$message.error(e.message))})},getStatus:function(){var t=this;Object(l.f)(this.shop.shopId).then(function(e){console.log("获取店铺计费方式",e),t.radioForm.freightRule=""+e.data.freightRule})},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.listForm.pageSize=t,this.getData()},handleCurrentChange:function(t){console.log("当前页: "+t),this.listForm.pageNum=t,this.getData()},closeRules:function(t){console.log(t),this.showRules=!1}},components:{rules:a.default},computed:s()({},Object(i.c)(["user","shop"]))},c=(o("KXTZ"),o("KHd+")),u=Object(c.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pageContent"},[o("div",{staticClass:"pageHead"},[t._v("快递发货功能")]),t._v(" "),o("el-card",{staticClass:"box-card"},[o("span",[t._v("计费方式：")]),t._v(" "),o("el-radio",{attrs:{disabled:t.radioLoading,label:"0"},on:{change:t.changeRadio},model:{value:t.radioForm.freightRule,callback:function(e){t.$set(t.radioForm,"freightRule",e)},expression:"radioForm.freightRule"}},[t._v("组合运费")]),t._v(" "),o("el-radio",{attrs:{disabled:t.radioLoading,label:"1"},on:{change:t.changeRadio},model:{value:t.radioForm.freightRule,callback:function(e){t.$set(t.radioForm,"freightRule",e)},expression:"radioForm.freightRule"}},[t._v("累加运费")]),t._v(" "),o("el-button",{staticStyle:{"margin-left":"40px"},on:{click:function(e){t.showRules=!0}}},[t._v("运费计费规则")])],1),t._v(" "),o("el-card",{staticClass:"operate-container",staticStyle:{margin:"20px 0"},attrs:{shadow:"never"}},[o("div",{staticClass:"flex-row-between",staticStyle:{width:"100%"}},[o("div",[o("i",{staticClass:"el-icon-tickets"}),t._v(" "),o("span",[t._v("数据列表")])]),t._v(" "),o("div",{staticStyle:{"padding-right":"20px"}},[o("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(e){t.$router.push({path:"/logistics/logisticsTemplate/newTemplate"})}}},[t._v("新建运费模板")])],1)])]),t._v(" "),o("div",[o("el-card",{staticClass:"box-card table"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.freightTemplateRuleDtoList}},[o("el-table-column",{attrs:{label:"可配送区域"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.distributionAreaName)+"\n                ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"首件（个）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.firstPiece)+"\n                ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"运费（元）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.firstFreightPrice)+"\n                ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"续件（个）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.addPiece)+"\n                ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"续费（元）"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.addFreightPrice)+"\n                ")]}}])})],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"运费模板名称",prop:"templateName"}}),t._v(" "),o("el-table-column",{attrs:{label:"使用此模板的商品个数",prop:"productCount"}}),t._v(" "),o("el-table-column",{attrs:{label:"最后编辑时间",prop:"updateTime"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.isDefault?o("el-button",{staticStyle:{color:"#E6A23C"},attrs:{type:"text",size:"small"}},[t._v("默认")]):t._e(),t._v(" "),1==e.row.isDefault?o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){t.setDefault(e.row)}}},[t._v("设为默认")]):t._e(),t._v(" "),o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){t.$router.push({path:"/logistics/logisticsTemplate/editTemplate",query:{templateId:e.row.id}})}}},[t._v("编辑")]),t._v(" "),o("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",size:"small"},on:{click:function(o){t.deleteItem(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),o("div",{staticStyle:{padding:"20px 0 0 0"}},[o("el-pagination",{attrs:{"page-sizes":[5,10,15,20],"page-size":t.listForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.listTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),o("rules",{attrs:{rulesShow:t.showRules},on:{closeRules:t.closeRules,"update:rulesShow":function(e){t.showRules=e}}})],1)},[],!1,null,null,null);u.options.__file="logisticsTemplate.vue";e.default=u.exports},rNa8:function(t,e,o){},rbj7:function(t,e,o){"use strict";o.r(e);var n={props:{rulesShow:{type:Boolean,default:!1}},data:function(){return{close:!1}},methods:{click:function(){this.$emit("closeRules",!0)}}},s=o("KHd+"),a=Object(s.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-dialog",{attrs:{"close-on-press-escape":t.close,"close-on-click-modal":t.close,"show-close":t.close,visible:t.rulesShow,center:"",title:"运费模板",width:"70%"},on:{"update:visible":function(e){t.rulesShow=e}}},[o("div",[o("div",{staticStyle:{"margin-bottom":"20px","text-align":"center","font-size":"16px"}},[t._v("选择相应的运费模板，即可指定该商品，可配送至相应区域，并按规则收取相应运费,包括：累加运费和组合运费两种规则")]),t._v(" "),o("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[o("el-col",{attrs:{span:11}},[o("el-card",{attrs:{shadow:"hover"}},[o("p",{staticStyle:{"margin-bottom":"20px"}},[t._v("\n              累加运费：分别计算出来商品使用模板的运费最大值，进行累加。不计算包邮商品的运费\n            ")]),t._v(" "),o("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("\n              1.不同或相同的商品，设置同一运费模板：按该模板设置的规则计算，不足续件或者续重的数目的时候，仍然按照续件或者续重的数目进行计算。例：商品A，B都是用模板X（首件10元，续2件5元），如果购买商品A和B，各一件，则一共购买两件，运费=10+5=15元。购买A一件，B两件，则一共购买三件，运费=10+5=15元。\n            ")]),t._v(" "),o("p",[t._v("\n              2.不同的商品，设置不同的运费模板：分别计算每个运费模板规则应收运费，再累加计算合计运费；例如： 例如商品A（1件）使用用模板X（首1件，10元，续2件，5元），商品B（1件）使用模板Z（首2件，12元，续1件，5元），如果购买商品A和B各2件，则运费=模板X的运费+模板Z的运费=（10+5）+（12）=27元。\n            ")])])],1),t._v(" "),o("el-col",{attrs:{span:11}},[o("el-card",{attrs:{shadow:"hover"}},[o("p",[t._v("组合运费：")]),t._v(" "),o("p",[t._v("1)计算使用运费模板的运费价格x：取所有商品中，首件/首重金额最大的运费模板，计算使用该模板的所有商品运费；使用其他模板的所有商品都按照该商品所试用的续件/续费金额来计算；最后再求和")]),t._v(" "),o("p",[t._v("2）计算使用统一运费的商品运费y：取最大的统一运费。")]),t._v(" "),o("p",[t._v("3）比较x和y，运费=x和y的较大值。")]),t._v(" "),o("p",{staticStyle:{"margin-bottom":"20px"}},[t._v("4）不计算包邮商品的运费")]),t._v(" "),o("p",[t._v("例如：")]),t._v(" "),o("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("1.不同或相同的商品，设置同一运费模板：同按商品累加运费的计算方式，按该模板设置的规则计算。例：商品A，B都是用模板M（首件10元，续2件5元），如果购买商品A和B，各一件，则一共购买两件，运费=10+5=15元。")]),t._v(" "),o("p",[t._v("2.不同的商品，设置不同的运费模板：不同于按照商品累加的计算方式。例： 例如商品A（1件）使用用模板M（首1件，10元，续1件，5元），商品B使用模板N（首2件，12元，续1件，5元），如果购买商品A和B，各2件，则运费=模板N的运费（首费为12，大于模板M的10）+模板M的运费（按照续费计算）=（12）+（5*2）=22元。如果按商品累加计费，则运费=模板M的运费+模板N的运费=（10+5）+（12）=27元。")])])],1)],1)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.click}},[t._v("确 定")])],1)])],1)},[],!1,null,null,null);a.options.__file="rules.vue";e.default=a.exports}}]);
//# sourceMappingURL=chunk-2666.b9a96f76.js.map