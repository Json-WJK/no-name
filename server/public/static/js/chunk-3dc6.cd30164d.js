(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3dc6","WFwG"],{"1DsJ":function(t,e,o){"use strict";var i=o("Ii1l");o.n(i).a},"4jk9":function(t,e,o){},"8/xu":function(t,e,o){"use strict";var i=o("4jk9");o.n(i).a},Ii1l:function(t,e,o){},PKtf:function(t,e,o){"use strict";o.r(e);var i=o("QbLZ"),s=o.n(i),r=o("4d7F"),a=o.n(r),n=o("L2JU"),l=o("pgPq"),c=o("PRgn"),d={data:function(){return{showImgMaterial:!1,showImgMaterialType:"",getPost:!1,searchList:{name:""},dataLoading:!1,list:[],showAddFirstDia:!1,firstForm:{},firstFormLoading:!1,showEditFirstDia:!1,firstEditForm:{},firstEditFormLoading:!1,showAddSecondDia:!1,secondFormLoading:!1,secondForm:{showImg:!1},showImg:!1,showEditSecondDia:!1,secondEditFormLoading:!1,secondEditForm:{showImg:!1},rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},expands:[]}},created:function(){this.searchList.shopId=this.shop.shopId,this.getData()},methods:{showAddSecondDiafun:function(t){console.log("e",t),this.secondForm.parentId=t.id,this.secondForm.parentName=t.name,this.showAddSecondDia=!0},addSedcond:function(t){var e=this;this.secondForm.name?this.secondForm.imageUrl?(this.secondFormLoading=!0,this.secondForm.shopId=this.shop.shopId,this.secondForm.level=2,console.log("添加二级分类请求的数据",this.secondForm),this.checkName(this.secondForm).then(function(o){console.log("有没有名字",o),200==o.code?e.add(e.secondForm,t):(e.secondFormLoading=!1,e.$message.error(o.message))})):this.$message.error("请上传二级分类图片后再试"):this.$message.error("请正确输入二级分类名称")},showEditSecondDiafun:function(t,e){console.log("e",t,e),this.secondEditForm.parentId=e.id,this.secondEditForm.parentName=e.name,this.secondEditForm.showImg=!0,this.secondEditForm.imageUrl=t.imageUrl,this.secondEditForm.name=t.name,this.secondEditForm.oldname=t.name,this.secondEditForm.id=t.id,this.showEditSecondDia=!0},editSedcond:function(t){var e=this;this.$refs[t].validate(function(o){if(!o)return console.log("error submit!!"),!1;e.secondEditForm.imageUrl?(e.secondEditFormLoading=!0,e.secondEditForm.shopId=e.shop.shopId,e.secondEditForm.level=2,e.secondEditForm.oldname==e.secondEditForm.name?e.edit(e.secondEditForm,t):e.checkName(e.secondEditForm).then(function(o){console.log("有没有名字",o),200==o.code?e.edit(e.secondEditForm,t):(e.secondEditFormLoading=!1,e.$message.error(o.message))})):e.$message.error("请上传二级分类图片后再试")})},moveFirst:function(t,e){var o={};o.id=this.list[t].id;var i=void 0;1==e&&(i=0),2==e&&(i=t-1),3==e&&(i=t+1),4==e&&(i=this.list.length-1),o.chanageId=this.list[i].id,this.move(o)},moveSecond:function(t,e,o){var i={};i.id=t.productCategoryShopList[e].id;var s=void 0;1==o&&(s=0),2==o&&(s=e-1),3==o&&(s=e+1),4==o&&(s=t.productCategoryShopList.length-1),i.chanageId=t.productCategoryShopList[s].id,this.move(i)},move:function(t){var e=this;Object(c.h)(t).then(function(t){console.log("移动",t),200==t.code?(e.$message({message:"移动成功",type:"success"}),e.getData()):e.$message.error(t.message)})},deleteItem:function(t){var e=this;0==t.productCount?Object(c.a)({id:t.id}).then(function(t){console.log("删除分类",t),200==t.code?(e.$message({message:"删除成功",type:"success"}),e.getData()):e.$message.error(t.message)}):this.$confirm("批量修改分组后，便可删除","当前有商品在该分组下，无法删除",{confirmButtonText:"确定",cancelButtonText:"去修改",type:"warning"}).then(function(){}).catch(function(){var t=e.$router.resolve({name:"商品列表"});console.log("details",t),window.open(t.href,"_blank")})},checkName:function(t){var e=this;return new a.a(function(o,i){Object(c.f)(t).then(function(t){console.log("验证名字",t),200==t.code?o(t):(e.firstFormLoading=!1,e.firstEditFormLoading=!1,e.secondFormLoading=!1,e.secondEditFormLoading=!1,e.$message.error(t.message))})})},add:function(t,e){var o=this;Object(c.e)(t).then(function(t){console.log("添加分类",t),200==t.code?(o.$message({message:"添加成功",type:"success"}),o.getData(),"firstForm"==e&&(o.firstForm.name="",o.showAddFirstDia=!1),"secondForm"==e&&(o.showAddSecondDia=!1,o.secondForm.imageUrl="",o.secondForm.showImg=!1,o.secondForm.name=""),setTimeout(function(){o.firstFormLoading=!1,o.secondFormLoading=!1},1e3)):(o.$message.error(t.message),o.firstFormLoading=!1,o.secondFormLoading=!1)})},addFirst:function(t){var e=this;this.firstForm.name?(this.firstFormLoading=!0,this.firstForm.shopId=this.shop.shopId,this.firstForm.level=1,this.firstForm.parentId=0,this.checkName(this.firstForm).then(function(o){console.log("有没有名字",o),200==o.code?e.add(e.firstForm,t):(e.firstFormLoading=!1,e.$message.error(o.message))})):this.$message.error("请输入分类名称")},edit:function(t,e){var o=this;Object(c.g)(t).then(function(t){console.log("编辑分类",t),200==t.code?(o.$message({message:"添加成功",type:"success"}),o.getData(),"firstEditForm"==e&&(o.showEditFirstDia=!1,o.firstEditForm.name=""),"secondEditForm"==e&&(o.showEditSecondDia=!1,o.secondEditForm.imageUrl="",o.secondEditForm.showImg=!1,o.secondEditForm.name=""),setTimeout(function(){o.firstEditFormLoading=!1,o.secondEditFormLoading=!1},1e3)):(o.$message.error(t.message),o.firstEditFormLoading=!1,o.secondEditFormLoading=!1)})},editFirstShow:function(t){this.firstEditForm.id=t.id,this.firstEditForm.name=t.name,this.firstEditForm.oldname=t.name,this.showEditFirstDia=!0},editFirst:function(t){var e=this;if(this.firstEditForm.name){if(this.firstEditForm.oldname==this.firstEditForm.name)return this.$message({message:"编辑成功",type:"success"}),void(this.showEditFirstDia=!1);this.firstEditFormLoading=!0,this.firstEditForm.shopId=this.shop.shopId,this.firstEditForm.level=1,this.firstEditForm.parentId=0,this.checkName(this.firstEditForm).then(function(o){console.log("有没有名字",o),200==o.code?e.edit(e.firstEditForm,t):(e.firstEditFormLoading=!1,e.$message.error(o.message))})}else this.$message.error("请输入分类名称")},deleteImg:function(t){"add"==t&&(this.secondForm.showImg=!1,this.secondForm.imageUrl=""),"edit"==t&&(this.secondEditForm.showImg=!1,this.secondEditForm.imageUrl="")},resetForm:function(t){"firstForm"==t&&(this.showAddFirstDia=!1),"secondForm"==t&&(this.showAddSecondDia=!1),"firstEditForm"==t&&(this.showEditFirstDia=!1),"secondEditForm"==t&&(this.showEditSecondDia=!1)},getData:function(){var t=this;Object(c.b)(this.searchList).then(function(e){console.log("店铺分类列表",e),t.list=e.data.list})},reset:function(){this.searchList.name="",this.getData()},change:function(t){this.$forceUpdate()},expandChange:function(t){Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)},this.expands.indexOf(t.id)<0?this.expands=[]:(this.expands.remove(t.id),this.expands=[])},rowClick:function(t,e,o){this.expandChange(t)},getRowKeys:function(t){return t.id},showImgMaterialDia:function(t){this.getPost=!0,this.showImgMaterial=!0,this.showImgMaterialType=t},onlyclose:function(t){console.log("值点了关闭",t),this.showImgMaterial=!1,this.getPost=!1},subMit:function(t){console.log("点击了确定",t),this.showImgMaterial=!1,this.getPost=!1,"add"==this.showImgMaterialType&&(this.secondForm.showImg=!0,this.secondForm.imageUrl=t[0].imageUrl),"edit"==this.showImgMaterialType&&(this.secondEditForm.showImg=!0,this.secondEditForm.imageUrl=t[0].imageUrl)}},computed:s()({},Object(n.c)(["user","shop"])),components:{imageMaterial:l.a}},m=(o("1DsJ"),o("KHd+")),u=Object(m.a)(d,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pageContent"},[o("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[o("div",[o("i",{staticClass:"el-icon-search"}),t._v(" "),o("span",[t._v("筛选搜索")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.getData}},[t._v("查询")]),t._v(" "),o("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:t.reset}},[t._v("重置")])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"15px"}},[o("el-form",{attrs:{inline:!0,model:t.searchList,size:"small","label-width":"140px"}},[o("el-form-item",{attrs:{label:"分类名称："}},[o("el-input",{staticStyle:{width:"203px"},attrs:{clearable:"",placeholder:"分类名称"},model:{value:t.searchList.name,callback:function(e){t.$set(t.searchList,"name",e)},expression:"searchList.name"}})],1)],1)],1)]),t._v(" "),o("el-card",{staticClass:"operate-container",staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[o("div",{staticClass:"flex-row-between",staticStyle:{width:"100%"}},[o("div",[o("i",{staticClass:"el-icon-tickets"}),t._v(" "),o("span",[t._v("数据列表")])]),t._v(" "),o("div",{staticStyle:{"padding-right":"20px"}},[o("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(e){t.showAddFirstDia=!0}}},[t._v("新增分类")])],1)])]),t._v(" "),o("div",[o("el-card",{staticClass:"filter-container",staticStyle:{"margin-top":"20px"},attrs:{shadow:"never"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":t.getRowKeys,"expand-row-keys":t.expands}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.productCategoryShopList,border:""}},[o("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),t._v(" "),o("el-table-column",{attrs:{label:"分类图标"},scopedSlots:t._u([{key:"default",fn:function(t){return[o("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.imageUrl,fit:"fill"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"productCount",label:"商品数量"}}),t._v(" "),o("el-table-column",{attrs:{label:"移动"},scopedSlots:t._u([{key:"default",fn:function(i){return[o("i",{directives:[{name:"show",rawName:"v-show",value:0!=i.$index,expression:"scope.$index != 0"}],staticClass:"el-icon-top icon ml",on:{click:function(o){t.moveSecond(e.row,i.$index,2)}}}),t._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:i.$index!=e.row.productCategoryShopList.length-1,expression:"scope.$index != props.row.productCategoryShopList.length -1"}],staticClass:"el-icon-bottom icon ml",on:{click:function(o){t.moveSecond(e.row,i.$index,3)}}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:0==i.$index&&1==e.row.productCategoryShopList.length,expression:"scope.$index == 0 && props.row.productCategoryShopList.length == 1"}]},[t._v("-")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){t.showEditSecondDiafun(i.row,e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(e){t.deleteItem(i.row)}}},[t._v("删除")])]}}])})],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"分类名称",prop:"name"}}),t._v(" "),o("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),t._v(" "),o("el-table-column",{attrs:{label:"商品数量",prop:"productCount"}}),t._v(" "),o("el-table-column",{attrs:{label:"移动"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("i",{directives:[{name:"show",rawName:"v-show",value:0!=e.$index,expression:"scope.$index != 0"}],staticClass:"el-icon-top icon ml",on:{click:function(o){t.moveFirst(e.$index,2)}}}),t._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:e.$index!=t.list.length-1,expression:"scope.$index != list.length -1"}],staticClass:"el-icon-bottom icon ml",on:{click:function(o){t.moveFirst(e.$index,3)}}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:0==e.$index&&1==t.list.length,expression:"scope.$index == 0 && list.length == 1"}]},[t._v("-")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){t.showAddSecondDiafun(e.row)}}},[t._v("新增二级分类")]),t._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){t.editFirstShow(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){t.deleteItem(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"添加一级分类",visible:t.showAddFirstDia,width:"30%"},on:{"update:visible":function(e){t.showAddFirstDia=e}}},[o("el-form",{ref:"firstForm",staticClass:"demo-ruleForm",attrs:{model:t.firstForm,"label-width":"140px"}},[o("el-form-item",{attrs:{label:"一级分类名称：",required:""}},[o("el-input",{attrs:{maxlength:"5","show-word-limit":""},on:{input:function(e){t.change(e)}},model:{value:t.firstForm.name,callback:function(e){t.$set(t.firstForm,"name","string"==typeof e?e.trim():e)},expression:"firstForm.name"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{loading:t.firstFormLoading,type:"primary"},on:{click:function(e){t.addFirst("firstForm")}}},[t._v("确 认")]),t._v(" "),o("el-button",{on:{click:function(e){t.resetForm("firstForm")}}},[t._v("取 消")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"编辑一级分类",visible:t.showEditFirstDia,width:"30%"},on:{"update:visible":function(e){t.showEditFirstDia=e}}},[o("el-form",{ref:"firstEditForm",staticClass:"demo-ruleForm",attrs:{model:t.firstEditForm,"label-width":"140px"}},[o("el-form-item",{attrs:{label:"一级分类名称："}},[o("el-input",{attrs:{maxlength:"5","show-word-limit":""},on:{input:function(e){t.change(e)}},model:{value:t.firstEditForm.name,callback:function(e){t.$set(t.firstEditForm,"name",e)},expression:"firstEditForm.name"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{loading:t.firstEditFormLoading,type:"primary"},on:{click:function(e){t.editFirst("firstEditForm")}}},[t._v("确 认")]),t._v(" "),o("el-button",{on:{click:function(e){t.resetForm("firstEditForm")}}},[t._v("取 消")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"添加二级分类",visible:t.showAddSecondDia,width:"30%"},on:{"update:visible":function(e){t.showAddSecondDia=e}}},[o("el-form",{ref:"secondForm",staticClass:"demo-ruleForm",attrs:{model:t.secondForm,rules:t.rules,"label-width":"140px"}},[o("el-form-item",{attrs:{label:"一级分类名称："}},[o("div",[t._v(t._s(t.secondForm.parentName))])]),t._v(" "),o("el-form-item",{attrs:{label:"二级分类名称：",requeired:""}},[o("el-input",{attrs:{maxlength:"10","show-word-limit":""},on:{input:function(e){t.change(e)}},model:{value:t.secondForm.name,callback:function(e){t.$set(t.secondForm,"name",e)},expression:"secondForm.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"二级分类图片：",required:""}},[o("el-button",{attrs:{disabled:t.secondForm.showImg,type:"primary"},on:{click:function(e){t.showImgMaterialDia("add")}}},[t._v("添加图片"),o("i",{staticClass:"el-icon-upload el-icon--right"})]),t._v(" "),o("span",{staticStyle:{"font-size":"14px",color:"#909399"}},[t._v("建议尺寸198*198px")])],1),t._v(" "),t.secondForm.showImg?o("el-form-item",{attrs:{label:"",required:""}},[o("el-popover",{attrs:{placement:"right",trigger:"hover"}},[o("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(e){e.stopPropagation(),t.deleteImg("add")}}},[t._v("删除")]),t._v(" "),o("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{slot:"reference",src:t.secondForm.imageUrl,fit:"fill"},slot:"reference"})],1)],1):t._e(),t._v(" "),o("el-form-item",[o("el-button",{attrs:{loading:t.secondFormLoading,type:"primary"},on:{click:function(e){t.addSedcond("secondForm")}}},[t._v("确 认")]),t._v(" "),o("el-button",{on:{click:function(e){t.resetForm("secondForm")}}},[t._v("取 消")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"编辑二级分类",visible:t.showEditSecondDia,width:"30%"},on:{"update:visible":function(e){t.showEditSecondDia=e}}},[o("el-form",{ref:"secondEditForm",staticClass:"demo-ruleForm",attrs:{model:t.secondEditForm,rules:t.rules,"label-width":"140px"}},[o("el-form-item",{attrs:{label:"一级分类名称："}},[o("div",[t._v(t._s(t.secondEditForm.parentName))])]),t._v(" "),o("el-form-item",{attrs:{label:"二级分类名称：",prop:"name"}},[o("el-input",{attrs:{maxlength:"10","show-word-limit":""},on:{input:function(e){t.change(e)}},model:{value:t.secondEditForm.name,callback:function(e){t.$set(t.secondEditForm,"name",e)},expression:"secondEditForm.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"二级分类图片：",required:""}},[o("el-button",{attrs:{disabled:t.secondEditForm.showImg,type:"primary"},on:{click:function(e){t.showImgMaterialDia("edit")}}},[t._v("添加图片"),o("i",{staticClass:"el-icon-upload el-icon--right"})]),t._v(" "),o("span",{staticStyle:{"font-size":"14px",color:"#909399"}},[t._v("建议尺寸198*198px")])],1),t._v(" "),t.secondEditForm.showImg?o("el-form-item",{attrs:{label:"",required:""}},[o("el-popover",{attrs:{placement:"right",trigger:"hover"}},[o("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(e){e.stopPropagation(),t.deleteImg("edit")}}},[t._v("删除")]),t._v(" "),o("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{slot:"reference",src:t.secondEditForm.imageUrl,fit:"fill"},slot:"reference"})],1)],1):t._e(),t._v(" "),o("el-form-item",[o("el-button",{attrs:{loading:t.secondEditFormLoading,type:"primary"},on:{click:function(e){t.editSedcond("secondEditForm")}}},[t._v("确 认")]),t._v(" "),o("el-button",{on:{click:function(e){t.resetForm("secondEditForm")}}},[t._v("取 消")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"图片库",visible:t.showImgMaterial,width:"70%"},on:{"update:visible":function(e){t.showImgMaterial=e}}},[o("imageMaterial",{attrs:{limitType:!0,getPost:t.getPost,multiple:!1,totalNum:1,selectNum:0},on:{onlyclose:t.onlyclose,subMit:t.subMit}})],1)],1)},[],!1,null,"7b04a336",null);u.options.__file="commodityClassify.vue";e.default=u.exports},PRgn:function(t,e,o){"use strict";o.d(e,"b",function(){return s}),o.d(e,"e",function(){return r}),o.d(e,"a",function(){return a}),o.d(e,"f",function(){return n}),o.d(e,"h",function(){return l}),o.d(e,"g",function(){return c}),o.d(e,"d",function(){return d}),o.d(e,"c",function(){return m});var i=o("t3Un");function s(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryInfoList",method:"post",data:t})}function r(t){return Object(i.a)({url:"/product/business/productCategoryShop/insertProductCategoryShop",method:"post",data:t})}function a(t){return Object(i.a)({url:"/product/business/productCategoryShop/deleteProductCategoryShop",method:"post",data:t})}function n(t){return Object(i.a)({url:"/product/business/productCategoryShop/isCategoryNameExist?name="+t.name+"&level="+t.level+"&shopId="+t.shopId+"&parentId="+t.parentId,method:"get"})}function l(t){return Object(i.a)({url:"/product/business/productCategoryShop/updateProductCategoryShopOrderNo",method:"post",data:t})}function c(t){return Object(i.a)({url:"/product/business/productCategoryShop/updateProductCategoryShop",method:"post",data:t})}function d(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryShopAllList?shopId="+t,method:"get"})}function m(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryInfoPageList",method:"post",data:t})}},U7fH:function(t,e,o){"use strict";var i=o("ZB0S");o.n(i).a},WFwG:function(t,e,o){"use strict";o.d(e,"f",function(){return s}),o.d(e,"h",function(){return r}),o.d(e,"l",function(){return a}),o.d(e,"b",function(){return n}),o.d(e,"g",function(){return l}),o.d(e,"d",function(){return c}),o.d(e,"a",function(){return d}),o.d(e,"k",function(){return m}),o.d(e,"j",function(){return u}),o.d(e,"c",function(){return h}),o.d(e,"e",function(){return g}),o.d(e,"i",function(){return p});var i=o("t3Un");function s(t){return Object(i.a)({url:"/product/business/gallery/getGalleryByShopId?shopId="+t.shopId+"&galleryName="+(t.galleryName?t.galleryName:"")+"&type="+t.type,method:"get"})}function r(t){return Object(i.a)({url:"/product/business/gallery/insertGallery",method:"post",data:t})}function a(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryName",method:"post",data:t})}function n(t){return Object(i.a)({url:"/product/business/gallery/deleteGallery",method:"post",data:t})}function l(t){return Object(i.a)({url:"/product/business/gallery/getGalleryImageByGroup",method:"post",data:t})}function c(t){return Object(i.a)({url:"/product/business/gallery/deleteOssFile",method:"post",data:t})}function d(t){return Object(i.a)({url:"/product/business/gallery/addGalleryImage",method:"post",data:t})}function m(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryImageName",method:"post",data:t})}function u(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryImageGroup",method:"post",data:t})}function h(t){return Object(i.a)({url:"/product/business/gallery/deleteGalleryImage",method:"post",data:t})}function g(t){return Object(i.a)({url:"/product/business/gallery/getDeleteGallery",method:"post",data:t})}function p(t){return Object(i.a)({url:"/product/business/gallery/updateDeleteStatus",method:"post",data:t})}},ZB0S:function(t,e,o){},"jM9+":function(t,e,o){"use strict";var i=o("ri7H");o.n(i).a},pgPq:function(t,e,o){"use strict";var i=o("QbLZ"),s=o.n(i),r=o("L2JU"),a=o("WFwG"),n={props:["getPost","limitType","multiple","totalNum","selectNum"],watch:{getPost:function(t,e){t&&(console.log("执行了"),this.selectImgArr=[],this.getGaller(),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0)}},data:function(){return{selectImgArr:[],hideUpload:!1,imageClassTags:[],getGalleryForm:{},getImgsForm:{pageSize:30,pageNum:1},imgs:[],imgsTotal:0,uploadImg:!1,uploadImgLoading:!1,uploadImgForm:{galleryId:0},galleryList:[],activeClassName:"",updateClassArr:[],ImageBoxHeight:0,OperationHeight:0,action:""}},created:function(){console.log("图片库created的multiple",this.multiple),console.log("图片库created的totalNum",this.totalNum),console.log("图片库created的selectNum",this.selectNum),this.getGalleryForm.shopId=this.shop.shopId,this.getGalleryForm.type=1,this.getImgsForm.shopId=this.shop.shopId,this.getImgsForm.type=1,this.action="/product/business/gallery/uploadGalleryImage?shopId="+this.shop.shopId,this.getGaller()},mounted:function(){var t=this;console.log("执行了mounted"),this.$nextTick(function(){this.OperationHeight=window.innerHeight-282,this.ImageBoxHeight=window.innerHeight-400}),window.onresize=function(){return t.OperationHeight=window.innerHeight-282,void(t.ImageBoxHeight=window.innerHeight-400)}},methods:{showPos:function(t){return-1!==this.selectImgArr.findIndex(function(e){return e.id==t.id})},showNum:function(t){return this.selectImgArr.findIndex(function(e){return e.id==t.id})+1},clickItem:function(t){if(-1===this.selectImgArr.findIndex(function(e){return e.id==t.id})){if(this.limitType&&this.totalNum-this.selectNum-this.selectImgArr.length<=0)return void this.$message.error("已超过添加最大图片数量");this.selectImgArr.push(t)}else this.selectImgArr.splice(this.selectImgArr.findIndex(function(e){return e.id===t.id}),1)},onlyClose:function(){this.$emit("onlyclose",!0)},subMit:function(){console.log("this.selectImgArr",this.selectImgArr),0!=this.selectImgArr.length?this.$emit("subMit",this.selectImgArr):this.$message.error("请先选择图片")},getImgs:function(){var t=this;Object(a.g)(this.getImgsForm).then(function(e){console.log("获取分类下图片",e);var o=e.data.list;o.forEach(function(t){return t.checked=!1}),t.imgs=o,t.imgsTotal=e.data.total})},imgUp:function(t,e){console.log(t,e);var o={};o.imageName=t.data[0].orginName,o.imageSize=t.data[0].size,o.imageUrl=t.data[0].name,o.width=t.data[0].width,o.height=t.data[0].height,this.galleryList.push(o),this.selectImgArr.push(o),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0},imgRemove:function(t,e){var o=this;if(console.log("图片删除",t,e),t.response){var i={},s=[],r={};r.imageUrl=t.response.data[0].name,s.push(r),i.shopId=this.shop.shopId,i.type=1,i.galleryList=s,this.deleteImgFun(i),this.galleryList=[],e.forEach(function(t){var e={};e.imageName=t.response.data[0].orginName,e.imageSize=t.response.data[0].size,e.imageUrl=t.response.data[0].name,e.width=t.response.data[0].width,e.height=t.response.data[0].height,o.galleryList.push(e)});var a=t.response.data[0].uid;this.selectImgArr.splice(this.selectImgArr.findIndex(function(t){return(t.uid&&t.uid)===a}),1),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0,console.log("删除后的已选择",this.selectImgArr)}},deleteImgFun:function(t){Object(a.d)(t).then(function(t){console.log("删除oss资源",t)})},uploadImgFun:function(){var t=this;this.uploadImgForm.type=1,this.uploadImgForm.shopId=this.shop.shopId,0!=this.galleryList.length?(this.uploadImgLoading=!0,this.uploadImgForm.galleryList=this.galleryList,Object(a.a)(this.uploadImgForm).then(function(e){console.log("上传图片保存",e),200==e.code?(t.$message({message:"恭喜，上传成功",type:"success"}),t.uploadImg=!1,t.uploadImgForm.galleryId=0,t.galleryList=[],t.$refs.upload.clearFiles(),t.subMit(),setTimeout(function(){t.uploadImgLoading=!1},1e3)):(t.uploadImgLoading=!1,t.$message.error(e.message))})):this.$message.error("请先上传图片")},showUploadImg:function(){this.limitType&&this.totalNum-this.selectNum-this.selectImgArr.length<=0?this.$message.error("已超过添加最大图片数量"):this.uploadImg=!0},uploadImgClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(o){console.log("执行了",e.galleryList);var i={},s=[];e.galleryList.forEach(function(t){var e={};e.imageUrl=t.imageUrl,s.push(e)}),i.shopId=e.shop.shopId,i.type=1,i.galleryList=s,e.galleryList=[],e.$refs.upload.clearFiles(),e.deleteImgFun(i),t()}).catch(function(t){})},handleExceed:function(t,e){this.$message.warning("单次最多上传"+(this.totalNum-this.selectNum-this.selectImgArr.length)+"张图片，共选择了 "+(t.length+e.length)+" 个文件")},beforeAvatarUpload:function(t){console.log("file",t);var e="image/jpeg"===t.type||"image/gif"===t.type||"image/png"===t.type||"image/bmp"===t.type;console.log(e);var o=t.size/1024/1024<3;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&o},getGaller:function(){var t=this;console.log("请求分类的数据",this.getGalleryForm),Object(a.f)(this.getGalleryForm).then(function(e){console.log("获取图片库分组",e);var o=e.data;if(o.forEach(function(t){t.type="info"}),""==t.activeClassName)t.activeClassName=o[0].galleryName,o[0].type="",t.getImgsForm.galleryId=o[0].id;else{var i=o.findIndex(function(e){return e.galleryName==t.activeClassName});o[i].type="",t.getImgsForm.galleryId=o[i].id}for(var s=[],r=1;r<o.length;r++)s.push(o[r]);t.updateClassArr=s,t.changeClassArr=s,console.log("arr",s),t.getImgs(),t.imageClassTags=o})},activeClass:function(t){console.log("点击了分组按钮"),this.imageClassTags.forEach(function(t){return t.type="info"}),t.type="",this.allChecked=!1,this.getImgsForm.galleryId=t.id,this.activeClassName=t.galleryName,this.getImgs()},handleSizeChange:function(t){this.getImgsForm.pageSize=t,this.getImgs()},handleCurrentChange:function(t){this.getImgsForm.pageNum=t,this.getImgs()},change:function(t){this.$forceUpdate()}},computed:s()({},Object(r.c)(["user","shop"]))},l=(o("jM9+"),o("U7fH"),o("8/xu"),o("KHd+")),c=Object(l.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"box"},[o("div",{staticClass:"flex-row-start"},[o("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("div",{staticClass:"materinalOperation"},[o("el-card",{staticClass:"box-card"},[o("div",{staticClass:"search",staticStyle:{"margin-bottom":"20px"}},[o("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索分组"},model:{value:t.getGalleryForm.galleryName,callback:function(e){t.$set(t.getGalleryForm,"galleryName",e)},expression:"getGalleryForm.galleryName"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getGaller},slot:"append"})],1)],1),t._v(" "),o("div",{staticClass:"class flex-column-center"},[o("div",{staticClass:"classList",style:{height:t.OperationHeight+"px"},attrs:{height:t.OperationHeight+"px"}},[o("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto",height:"100%"}},t._l(t.imageClassTags,function(e){return o("li",{key:e.name,staticClass:"li infinite-list-item",on:{click:function(o){t.activeClass(e)}}},[o("el-tag",{staticStyle:{width:"100%"},attrs:{type:e.type}},[t._v(t._s(e.galleryName)+" "+t._s(-1===e.id?"":"( "+e.totalAmount+" )"))])],1)}))])])])],1)]),t._v(" "),o("el-col",{attrs:{span:18}},[o("div",{staticClass:"materinalContent"},[o("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[o("h3",{staticStyle:{"margin-bottom":"20px"}},[t._v(t._s(t.activeClassName))]),t._v(" "),o("div",{staticClass:"flex-row-between"},[o("el-button",{attrs:{type:"primary"},on:{click:t.showUploadImg}},[t._v("上传图片")]),t._v(" "),o("div",{staticClass:"search"},[o("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索图片"},model:{value:t.getImgsForm.imageName,callback:function(e){t.$set(t.getImgsForm,"imageName",e)},expression:"getImgsForm.imageName"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getImgs},slot:"append"})],1)],1)],1)]),t._v(" "),o("el-card",{staticClass:"box-card"},[t.imgs.length>0?o("div",[o("div",{staticClass:"classList",style:{height:t.ImageBoxHeight+"px"}},[o("ul",{staticClass:"infinite-list flex-row-start1 ul",staticStyle:{"overflow-x":"hidden","overflow-y":"auto",height:"100%"}},t._l(t.imgs,function(e,i){return o("li",{key:i,staticClass:"infinite-list-item item",on:{click:function(o){t.clickItem(e,i)}}},[o("div",{staticClass:"demo-image__preview"},[o("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{fit:"fill",src:e.imageUrl}}),t._v(" "),o("div",{staticClass:"imgNameBox"},[t._v(t._s(e.imageName))]),t._v(" "),o("div",{staticStyle:{"text-align":"center",color:"#909399"}},[t._v(t._s(e.width+" x "+e.height))])],1),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showPos(e),expression:"showPos(item)"}],staticClass:"pos"},[t._v(t._s(t.showNum(e)))])])}))]),t._v(" "),o("div",{staticClass:"fy flex-row-end"},[o("div",[o("el-pagination",{attrs:{"page-sizes":[10,20,30],"page-size":t.getImgsForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.imgsTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]):o("div",[t._v("暂无图片，可以点击左上角“上传图片”按钮添加")])])],1)])],1)],1),t._v(" "),o("div",{staticClass:"flex-row-between",staticStyle:{"margin-top":"10px"}},[t.limitType?o("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 张，还可以选择 "+t._s(t.totalNum-t.selectNum-t.selectImgArr.length)+" 张")]):o("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 张")]),t._v(" "),o("div",[o("el-button",{on:{click:t.onlyClose}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.subMit}},[t._v("确 定")])],1)])]),t._v(" "),o("el-dialog",{attrs:{title:"上传图片",visible:t.uploadImg,"before-close":t.uploadImgClose,"modal-append-to-body":!1,width:"65%"},on:{"update:visible":function(e){t.uploadImg=e}}},[o("el-form",{ref:"editGalleryForm",staticClass:"demo-ruleForm",attrs:{model:t.uploadImgForm,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"本地图片"}},[o("el-upload",{ref:"upload",class:{hide:t.hideUpload},attrs:{action:t.action,name:"files",multiple:t.multiple,"list-type":"picture-card","on-success":t.imgUp,"on-remove":t.imgRemove,"on-exceed":t.handleExceed,limit:t.limitType?t.totalNum-t.selectNum-t.selectImgArr.length:9999,"before-upload":t.beforeAvatarUpload}},[o("i",{staticClass:"el-icon-plus"}),t._v(" "),t.limitType?o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("单次最多上传"+t._s(this.totalNum-this.selectNum-this.selectImgArr.length)+"张图片，仅支持 gif、 jpeg、 png、 bmp 4种格式, 大小不超过3.0 MB")]):o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("仅支持 gif、 jpeg、 png、 bmp 4种格式, 大小不超过3.0 MB")])])],1),t._v(" "),o("el-form-item",{attrs:{label:"选择分组"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadImgForm.galleryId,callback:function(e){t.$set(t.uploadImgForm,"galleryId",e)},expression:"uploadImgForm.galleryId"}},t._l(t.updateClassArr,function(t){return o("el-option",{key:t.name,attrs:{label:t.galleryName,value:t.id}})}))],1),t._v(" "),o("el-form-item",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{loading:t.uploadImgLoading,type:"primary"},on:{click:t.uploadImgFun}},[t._v("确 定")])],1)],1)],1)],1)},[],!1,null,"3039c789",null);c.options.__file="imageMaterial.vue";e.a=c.exports},ri7H:function(t,e,o){}}]);
//# sourceMappingURL=chunk-3dc6.cd30164d.js.map