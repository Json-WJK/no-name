(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-64a9"],{"1hMO":function(t,e,o){},"6hMx":function(t,e,o){"use strict";var n=o("1hMO");o.n(n).a},"8uCk":function(t,e,o){"use strict";o.r(e);var n=o("P2sY"),i=o.n(n),a=o("FagV"),s=o("Jdu8"),r={productName:"",orderNo:"",invenetTime:"",tips:"1"},l={inject:["reload"],data:function(){return{tips:"1",tableList:[],totalCount:0,clock:!1,open:!1,inventoryCount:0,inventoryCountLost:0,textarea:"",input:"",num:"--",elseMoney:!1,successMoney:!1,lostMoney:!1,listQuery:i()({},r),list:{goodName:"",goodId:"",goodCode:""},code:"",userName:"",timer:null,tableData:[],tableDataPre:[],pageNum:1,page_size:10,total:0,totalAdd:0,dialogFormVisible:!1,updialogFormVisible:!1,category:"",outStock:{number:"",status:"",remark:"",productId:"",skuId:""},upStock:{number:"",status:"",remark:"",productId:"",skuId:""}}},created:function(){this.getInventoryList()},methods:{delect:function(t){var e=this;console.log(t),Object(s.a)({id:t.id}).then(function(t){console.log(t),200==t.code&&(e.$message.success({type:"success",message:t.message}),e.getDraftList())})},switchData:function(t){console.log(t),this.listQuery.orderType="",1==t?(this.pageNum=1,this.getInventoryList()):(this.getDraftList(),this.pageNum=1)},tepreservation:function(){var t=this,e={inventoryNo:this.code,shopId:localStorage.getItem("shopId"),bUserId:localStorage.getItem("userId"),profitCount:this.inventoryCount,lossCount:this.inventoryCountLost,categoryCount:this.category,productCount:this.totalCount,inventoryRemark:this.textarea,list:this.tableData};getDraft(e).then(function(e){console.log(e),200==e.code?(t.$message.success({type:"success",message:e.message}),t.reload()):t.$message.error({type:"error",message:e.message})})},complete:function(){var t=this,e={inventoryNo:this.code,shopId:localStorage.getItem("shopId"),bUserId:localStorage.getItem("userId"),profitCount:this.inventoryCount,lossCount:this.inventoryCountLost,categoryCount:this.category,productCount:this.totalCount,inventoryRemark:this.textarea,list:this.tableData};getProAdd(e).then(function(e){console.log(e),200==e.code?(t.$message.success({type:"success",message:e.message}),t.reload()):t.$message.error({type:"error",message:e.message})})},addCom:function(){this.$router.push({path:"/inventoryManagement/inventory"})},handleSelectionChange:function(t){console.log(t),this.multipleSelection=t,this.tableDataPre=t,this.totalCount=this.tableData.length},ck:function(t){var e=this;t.totalStockBefore>t.originalPriceAfter?t.salePriceBefore="盘盈":t.totalStockBefore<t.originalPriceAfter?t.salePriceBefore="盘亏":(t.totalStockBefore=t.originalPriceAfter)&&(t.salePriceBefore="无差异"),this.tableData.forEach(function(t){e.tableData.push()}),this.inventoryCount=0,this.inventoryCountLost=0;for(var o=0;o<this.tableData.length;o++)console.log(this.tableData[o].salePriceBefore),this.tableData[o].totalStockBefore>this.tableData[o].originalPriceAfter?this.inventoryCount++:this.tableData[o].totalStockBefore<this.tableData[o].originalPriceAfter&&this.inventoryCountLost++;console.log(this.inventoryCount,this.inventoryCountLost)},addType:function(){this.tableData=this.tableDataPre,this.tableData.forEach(function(t){t.salePriceBefore="--",t.remarks="",t.originalPriceAfter=""});var t={},e=this.tableData.reduce(function(e,o){return!t[o.categoryId3]&&(t[o.categoryId3]=e.push(o)),e},[]);this.category=e.length,this.dialogFormVisible=!1,this.searchList()},result:function(){this.dialogFormVisible=!1,this.searchList()},handleSearchList:function(){this.listQuery.pageNum=1,this.getInventoryList()},handleResetSearch:function(){this.listQuery=i()({},r),this.listQuery.pageNum=1,1==this.tips?this.getInventoryList():this.getDraftList()},searchList:function(){var t=this;Object(s.j)({pageNum:this.pageNum,pageSize:this.page_size,productName:this.list.goodName,skuCode:this.list.skuCode,productCode:this.list.goodId}).then(function(e){t.tableList=e.data.list,t.totalAdd=e.data.total})},getDraftList:function(){var t=this;Object(s.f)({shopId:localStorage.getItem("shopId"),pageSize:this.page_size,pageNum:this.pageNum,inventoryNo:this.listQuery.orderNo,createTime:this.listQuery.invenetTime}).then(function(e){console.log(e,"草稿列表"),t.tableData=e.data.list,t.total=e.data.total})},getInventoryList:function(){var t=this;Object(s.h)({shopId:localStorage.getItem("shopId"),pageSize:this.page_size,pageNum:this.pageNum,inventoryNo:this.listQuery.orderNo,createTime:this.listQuery.invenetTime}).then(function(e){console.log(e,"列表"),t.tableData=e.data.list,t.total=e.data.total})},replacef:function(t,e,o){var n=t.target,i=this;if("SPAN"==n.nodeName){var a=document.createElement("input");a.className="myStyle",a.value=n.innerHTML,n.parentNode.replaceChild(a,n),a.focus(),a.onblur=function(){n.innerHTML=a.value,a.parentNode.replaceChild(n,a),o.totalStockBefore>n.innerHTML?(i.successMoney=!0,i.lostMoney=!1,i.elseMoney=!1):o.totalStockBefore<n.innerHTML?(i.lostMoney=!0,i.successMoney=!1,i.elseMoney=!1):(o.totalStockBefore=n.innerHTML)&&(i.elseMoney=!0,i.successMoney=!1,i.lostMoney=!1)}}},reset:function(){this.list={goodName:"",goodId:"",goodCode:""},1==this.tips?this.getInventoryList():this.searchList()},handleSizeChange:function(t){this.page_size=t,1==this.tips?this.getInventoryList():this.searchList()},pageChange:function(t){this.pageNum=t,1==this.tips?this.getInventoryList():this.getDraftList()},outStockButton:function(){var t=this;"number"==typeof this.outStock.number?this.outStock.number>this.outStock.total?this.$notify.error({title:"错误",message:"出库量不能大于可用库存量"}):""!=this.outStock.status?Object(a.d)({shopId:localStorage.getItem("shopId"),productId:this.outStock.productId,skuId:this.outStock.skuId,type:this.outStock.status,totalStockChange:-this.outStock.number,remark:this.outStock.remark,creater:localStorage.getItem("userId")}).then(function(e){200==e.code?(t.$notify({title:"成功",message:"出库成功",type:"success"}),t.dialogFormVisible=!1,t.outStock.status="",t.outStock.skuId="",t.outStock.number="",t.outStock.remark="",t.searchList()):t.$notify.error({title:"失败",message:"出库失败"})}):this.$notify.error({title:"错误",message:"请选择出库类型"}):this.$notify.error({title:"错误",message:"请输入数字"})},check:function(t,e){this.$router.push({path:"/inventoryManagement/inventoryList/inventoryDetail",query:{id:e.id}})},goOninven:function(t){console.log(t),this.$router.push({path:"/inventoryManagement/inventory",query:{id:t.id}})},upStockButton:function(){var t=this;"number"==typeof this.upStock.number?""!=this.upStock.status?Object(a.d)({shopId:localStorage.getItem("shopId"),productId:this.upStock.productId,skuId:this.upStock.skuId,type:this.upStock.status,totalStockChange:this.upStock.number,remark:this.upStock.remark,creater:localStorage.getItem("userId")}).then(function(e){200==e.code?(t.$notify({title:"成功",message:"入库成功",type:"success"}),t.updialogFormVisible=!1,t.upStock.status="",t.upStock.skuId="",t.upStock.number="",t.upStock.remark="",t.searchList()):t.$notify.error({title:"失败",message:"入库失败"})}):this.$notify.error({title:"错误",message:"请选择入库类型"}):this.$notify.error({title:"错误",message:"请输入数字"})}}},c=(o("6hMx"),o("GP7D"),o("KHd+")),u=Object(c.a)(l,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("el-radio-group",{on:{change:t.switchData},model:{value:t.tips,callback:function(e){t.tips=e},expression:"tips"}},[o("el-radio-button",{attrs:{label:"1"}},[t._v("盘点记录")]),t._v(" "),o("el-radio-button",{attrs:{label:"2"}},[t._v("草稿箱")])],1),t._v(" "),o("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[o("div",[o("i",{staticClass:"el-icon-search"}),t._v(" "),o("span",[t._v("筛选搜索")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(e){t.handleSearchList()}}},[t._v("\n          查询搜索\n        ")]),t._v(" "),o("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(e){t.handleResetSearch()}}},[t._v("\n          重置\n        ")])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"15px"}},[o("el-form",{attrs:{inline:!0,model:t.listQuery,size:"small","label-width":"120px"}},[o("el-form-item",{attrs:{label:"单据编号："}},[o("el-input",{staticClass:"input-width",attrs:{placeholder:"订单编号"},model:{value:t.listQuery.orderNo,callback:function(e){t.$set(t.listQuery,"orderNo",e)},expression:"listQuery.orderNo"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"盘点日期："}},[o("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.listQuery.invenetTime,callback:function(e){t.$set(t.listQuery,"invenetTime",e)},expression:"listQuery.invenetTime"}})],1)],1)],1)]),t._v(" "),o("el-card",{staticClass:"operate-container",staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[o("i",{staticClass:"el-icon-tickets"}),t._v(" "),o("span",[t._v("数据列表")]),t._v(" "),1==t.tips?o("span",{staticClass:"tips"},[t._v("温馨提示：盘点单盘盈后会自动入库，盘亏后会自动出库；")]):t._e(),t._v(" "),2==t.tips?o("span",{staticClass:"tips"},[t._v("温馨提示：盘点时临时保存的盘点单，会进入草稿箱，可在草稿箱找到该盘点单，继续盘点；")]):t._e(),t._v(" "),o("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small",type:"primary"},on:{click:function(e){t.addCom()}}},[t._v("\n        新增盘点\n      ")])],1),t._v(" "),o("el-card",{staticClass:"operate-container",staticStyle:{"margin-top":"10px"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[o("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{label:"单据编号",width:"200","show-overflow-tooltip":"",prop:"name",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.inventoryNo)+"\n          ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"盘点日期",width:"200","min-width":"20%",prop:"createTime",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.createTime)+"\n          ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"盘点人","min-width":"15%",prop:"userName",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{label:"盘点商品条数","min-width":"15%",prop:"productCount",align:"center"}}),t._v(" "),1==t.tips?o("el-table-column",{attrs:{label:"盘盈数量","min-width":"15%",prop:"profitCount",align:"center"}}):t._e(),t._v(" "),1==t.tips?o("el-table-column",{attrs:{label:"盘亏数量","min-width":"15%",prop:"lossCount",align:"center"}}):t._e(),t._v(" "),1==t.tips?o("el-table-column",{attrs:{label:"商品种类","min-width":"15%",prop:"categoryCount",align:"center"}}):t._e(),t._v(" "),o("el-table-column",{attrs:{label:"单据备注","min-width":"15%",prop:"inventoryRemark",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",fixed:"right",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[2!=t.tips?o("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(o){t.check(e.$index,e.row)}}},[t._v("\n              查看\n            ")]):t._e(),t._v(" "),1!=t.tips?o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.delect(e.row)}}},[t._v("\n              删除\n            ")]):t._e(),t._v(" "),1!=t.tips?o("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(o){t.goOninven(e.row)}}},[t._v("\n              继续盘点\n            ")]):t._e()]}}])})],1)],1),t._v(" "),o("el-card",[o("div",{staticClass:"column"})]),t._v(" "),o("el-dialog",{attrs:{title:"添加商品",visible:t.dialogFormVisible,width:"1220px",height:"752px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("div",[o("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[o("div",[o("i",{staticClass:"el-icon-search"}),t._v(" "),o("span",[t._v("筛选搜索")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.searchList}},[t._v("\n              查询\n            ")]),t._v(" "),o("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:t.reset}},[t._v("\n              重置\n            ")])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"15px"}},[o("el-form",{attrs:{inline:!0,model:t.list,size:"small","label-width":"140px"}},[o("el-form-item",{attrs:{label:"商品名称："}},[o("el-input",{staticStyle:{width:"203px"},attrs:{clearable:"",placeholder:"商品名称"},model:{value:t.list.goodName,callback:function(e){t.$set(t.list,"goodName",e)},expression:"list.goodName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"商品编码："}},[o("el-input",{staticStyle:{width:"203px"},attrs:{clearable:"",placeholder:"商品编码"},model:{value:t.list.goodId,callback:function(e){t.$set(t.list,"goodId",e)},expression:"list.goodId"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"规格编码："}},[o("el-input",{staticStyle:{width:"203px"},attrs:{clearable:"",placeholder:"规格编码："},model:{value:t.list.goodCode,callback:function(e){t.$set(t.list,"goodCode",e)},expression:"list.goodCode"}})],1)],1)],1)]),t._v(" "),o("div",{staticClass:"table-container"},[o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableList,border:""},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{label:"分类",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n   "+t._s(e.row.categoryName3)+"\n")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"商品名称",width:"520",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n   "+t._s(e.row.productName)+"\n")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"商品编码",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n   "+t._s(e.row.productCode)+"\n")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"规格编码",width:"200","show-overflow-tooltip":"",prop:"name",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n   "+t._s(e.row.skuCode)+"\n")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"库存总数",width:"00",prop:"sumStock",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n   "+t._s(e.row.totalStockBefore)+"\n")]}}])})],1)],1),t._v(" "),o("div",{staticClass:"fixedB"},[o("div",{staticClass:"testButton"},[o("el-button",{on:{click:t.result}},[t._v("取消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.addType}},[t._v("确定")])],1)])],1)]),t._v(" "),o("div",{staticClass:"fixedB open"},[o("el-pagination",{staticStyle:{"margin-top":"10px","margin-left":"20px"},attrs:{background:"",layout:"total,sizes,prev,pager,next,jumper","page-size":t.page_size,"page-sizes":[10,30,50,100],"current-page":t.pageNum,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.pageChange}})],1)],1)},[],!1,null,"6267a858",null);u.options.__file="inventoryList.vue";e.default=u.exports},FagV:function(t,e,o){"use strict";o.d(e,"a",function(){return i}),o.d(e,"d",function(){return a}),o.d(e,"b",function(){return s}),o.d(e,"c",function(){return r});var n=o("t3Un");function i(t){return Object(n.a)({url:"/product/business/stock/findByCondition",method:"post",data:t})}function a(t){return Object(n.a)({url:"/product/business/stock/updateStockInOut",method:"post",data:t})}function s(t){return Object(n.a)({url:"/product/business/stockRecord/findByCondition",method:"post",data:t})}function r(t){return Object(n.a)({url:"/product/business/stockRecord/findByDetailCondition",method:"post",data:t})}},GP7D:function(t,e,o){"use strict";var n=o("yv/J");o.n(n).a},Jdu8:function(t,e,o){"use strict";o.d(e,"g",function(){return i}),o.d(e,"j",function(){return a}),o.d(e,"b",function(){return s}),o.d(e,"d",function(){return r}),o.d(e,"i",function(){return l}),o.d(e,"h",function(){return c}),o.d(e,"c",function(){return u}),o.d(e,"e",function(){return d}),o.d(e,"f",function(){return p}),o.d(e,"a",function(){return h});var n=o("t3Un");function i(t){return Object(n.a)({url:"/product/business/inventory/findByCondition",method:"post",data:t})}function a(t){return Object(n.a)({url:"/product/business/inventoryDraft/findByCondition",method:"post",data:t})}function s(t){return Object(n.a)({url:"/product/business/inventoryDraft/genInventoryNo",method:"post",data:t})}function r(t){return Object(n.a)({url:"/product/business/inventoryDraft/add",method:"post",data:t})}function l(t){return Object(n.a)({url:"/product/business/inventory/add",method:"post",data:t})}function c(t){return Object(n.a)({url:"/product/business/inventory/findByCondition",method:"post",data:t})}function u(t){return Object(n.a)({url:"/product/business/inventory/findById?id="+t.id,method:"post",data:t})}function d(t){return Object(n.a)({url:"/product/business/inventoryDraft/findDraftById?id="+t.id,method:"post",data:t})}function p(t){return Object(n.a)({url:"/product/business/inventoryDraft/findDraftByCondition",method:"post",data:t})}function h(t){return Object(n.a)({url:"/product/business/inventoryDraft/delDetail",method:"post",data:t})}},"yv/J":function(t,e,o){}}]);
//# sourceMappingURL=chunk-64a9.920f7c2b.js.map