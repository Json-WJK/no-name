(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c760"],{"/T+u":function(t,e,s){"use strict";s.d(e,"b",function(){return i}),s.d(e,"a",function(){return a}),s.d(e,"e",function(){return o}),s.d(e,"d",function(){return n}),s.d(e,"c",function(){return l});var r=s("t3Un");function i(t){return Object(r.a)({url:"/user/business/userMember/getUserManagementList",method:"post",data:t})}function a(t){return Object(r.a)({url:"/user/business/userMember/getUserDetails",method:"post",data:t})}function o(t){return Object(r.a)({url:"/user/business/userMember/updateUserDetails",method:"post",data:t})}function n(t){return Object(r.a)({url:"/user/business/userMember/saveUserVipRecord",method:"post",data:t})}function l(t){return Object(r.a)({url:"/user/business/userMember/prohibitUserVip?id="+t,method:"post"})}},vA8u:function(t,e,s){"use strict";s.r(e);var r=s("QbLZ"),i=s.n(r),a=s("L2JU"),o=s("/T+u"),n={data:function(){return{block:!1,firstOrderTime:[],lastOrderTime:[],list:[],searchList:{pageSize:5,startOrderAmount:"",endOrderAmount:"",keyWord:"",sourceType:"",address:"",sex:""},total:1,totalPage:1,tag:"",pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){var e=new Date;e.setTime(e.getTime()),e.setHours(e.getHours()),e.setMinutes(e.getMinutes()),e.setSeconds(e.getSeconds());var s=new Date;s.setTime(s.getTime()),s.setHours(0),s.setMinutes(0),s.setSeconds(0),t.$emit("pick",[s,e])}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),e.setHours(23),e.setMinutes(59),e.setSeconds(59);var s=new Date;s.setTime(s.getTime()-864e5),s.setHours(0),s.setMinutes(0),s.setSeconds(0),t.$emit("pick",[s,e])}},{text:"最近一周",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}}]},vipForm:{},vipShow:!1,multipleSelection:[]}},created:function(){this.searchList.shopId=this.shop.shopId,this.getData()},methods:{sendItem:function(t){this.vipForm.id=t.id,this.vipForm.createId=this.user.userId,this.vipShow=!0},sendAll:function(){if(console.log("this.multipleSelection",this.multipleSelection),0!=this.multipleSelection.length){var t=[];this.multipleSelection.forEach(function(e){return t.push(e.id)}),this.vipForm.id=t.join(","),this.vipForm.createId=this.user.userId,this.vipShow=!0}else this.$message.error("请选择后再试")},send:function(){var t=this;console.log("this.vipForm",this.vipForm),this.vipForm.numberTime?this.vipForm.unit?Object(o.d)(this.vipForm).then(function(e){console.log("赠送会员操作",e),200==e.code?(t.$message({message:"赠送成功",type:"success"}),t.vipForm.numberTime=void 0,t.vipForm.unit="",t.vipShow=!1,t.getData()):t.$message.error(e.message)}):this.$message.error("请选择要赠送天或月"):this.$message.error("请输入要赠送的天或月数")},stopItem:function(t){var e=this;this.$confirm("一旦操作将无法再次启用，请谨慎操作！","停用后此客户将不再享有会员相关权益",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.c)(t.id).then(function(t){console.log("停用会员",t),200==t.code&&(e.$message({type:"success",message:"停用成功!"}),e.getData())})}).catch(function(){})},change:function(t){this.$forceUpdate()},exportExcel:function(){var t=this;this.$confirm("确认导出excel?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e="shopId="+t.form.shopId+"&keyWord="+(t.form.keyWord||"")+"&startOrderTotal="+(t.form.startOrderTotal||"")+"&endOrderTotal="+(t.form.endOrderTotal||"")+"&startFirstOrderTime="+(t.form.startFirstOrderTime||"")+"&endFirstOrderTime="+(t.form.endFirstOrderTime||"")+"&sourceType="+(t.form.sourceType||"")+"&startOrderAmount="+(t.form.startOrderAmount||"")+"&endOrderAmount="+(t.form.endOrderAmount||"")+"&startLastOrderTime="+(t.form.startLastOrderTime||"")+"&endLastOrderTime="+(t.form.endLastOrderTime||"")+"&sex="+(t.form.sex||"")+"&address="+(t.form.address||"")+"&sort="+(t.form.sort||"")+"&sortType="+(t.form.sortType||"");window.open("/user/business/userMember/exportUserManagementList?"+e)}).catch(function(){})},tableSortChange:function(t){console.log(t),this.searchList.sortType=t.column.sortable;var e="";"ascending"==t.column.order&&(e=1),"descending"==t.column.order&&(e=2),this.searchList.sort=e,this.getData()},itemInfo:function(t){this.$router.push({path:"/customer/customerManage/customerDetails",query:{id:t}})},handleSelectionChange:function(t){this.multipleSelection=t},reset:function(){this.searchList.keyWord="",this.searchList.endOrderTotal="",this.searchList.startOrderTotal="",this.firstOrderTime=[],this.searchList.sourceType="",this.searchList.startOrderAmount="",this.searchList.endOrderAmount="",this.lastOrderTime=[],this.searchList.sex="",this.searchList.address="",this.searchList.isVip="",this.searchList.vipStatus="",this.getData()},getData:function(){var t=this;this.searchList.startFirstOrderTime=this.firstOrderTime[0]||"",this.searchList.endFirstOrderTime=this.firstOrderTime[1]||"",this.searchList.startLastOrderTime=this.lastOrderTime[0]||"",this.searchList.endLastOrderTime=this.lastOrderTime[1]||"",console.log("请求的数据",this.searchList),Object(o.b)(this.searchList).then(function(e){console.log("数据列表",e),200==e.code&&(t.list=e.data.list,t.total=e.data.total)})},proving:function(){this.searchList.startOrderTotal=Math.floor(this.searchList.startOrderTotal),this.searchList.endOrderTotal=Math.floor(this.searchList.endOrderTotal)},towMice:function(){this.searchList.startOrderAmount=(this.searchList.startOrderAmount/1).toFixed(2),this.searchList.endOrderAmount=(this.searchList.endOrderAmount/1).toFixed(2)},handleSizeChange:function(t){this.searchList.pageSize=t,this.getData()},handleCurrentChange:function(t){this.searchList.pageNum=t,this.getData()}},computed:i()({},Object(a.c)(["user","shop"]))},l=s("KHd+"),c=Object(l.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{margin:"20px"}},[s("el-card",{staticClass:"filter-container",staticStyle:{"margin-top":"20px"},attrs:{shadow:"never"}},[s("div",{staticStyle:{height:"45px"}},[s("i",{staticClass:"el-icon-search"}),t._v(" "),s("span",[t._v("筛选搜索")]),t._v(" "),s("el-button",{staticStyle:{float:"right","margin-right":"15px","margin-left":"0"},attrs:{type:"primary",size:"small"},on:{click:t.getData}},[t._v("查询")]),t._v(" "),s("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:t.reset}},[t._v("重置")])],1),t._v(" "),s("div",[s("el-form",{attrs:{inline:!0,size:"small","label-width":"140px"}},[s("el-form-item",{staticStyle:{"margin-right":"0"},attrs:{label:"关键词："}},[s("el-input",{staticStyle:{width:"203px"},attrs:{clearable:"",placeholder:"手机号 / 微信昵称 / 姓名"},on:{input:t.change},model:{value:t.searchList.keyWord,callback:function(e){t.$set(t.searchList,"keyWord",e)},expression:"searchList.keyWord"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"累计消费订单数："}},[s("el-input-number",{staticStyle:{width:"100px"},attrs:{controls:!1,"step-strictly":""},on:{input:t.change},model:{value:t.searchList.startOrderTotal,callback:function(e){t.$set(t.searchList,"startOrderTotal",e)},expression:"searchList.startOrderTotal"}}),t._v("  - \n          "),s("el-input-number",{staticStyle:{width:"100px"},attrs:{controls:!1,"step-strictly":""},on:{input:t.change},model:{value:t.searchList.endOrderTotal,callback:function(e){t.$set(t.searchList,"endOrderTotal",e)},expression:"searchList.endOrderTotal"}})],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-right":"0"},attrs:{label:"成为客户时间："}},[s("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.firstOrderTime,callback:function(e){t.firstOrderTime=e},expression:"firstOrderTime"}})],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-right":"14px"},attrs:{label:"来源："}},[s("el-select",{attrs:{placeholder:"请选择一个来源"},model:{value:t.searchList.sourceType,callback:function(e){t.$set(t.searchList,"sourceType",e)},expression:"searchList.sourceType"}},[s("el-option",{attrs:{label:"H5微商城",value:"0"}}),t._v(" "),s("el-option",{attrs:{label:"小程序",value:"1"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"累计消费金额："}},[s("el-input",{staticStyle:{width:"100px"},attrs:{type:"number",min:"0"},on:{change:t.towMice,input:t.change},model:{value:t.searchList.startOrderAmount,callback:function(e){t.$set(t.searchList,"startOrderAmount",e)},expression:"searchList.startOrderAmount"}}),t._v("   - \n          "),s("el-input",{staticStyle:{width:"100px"},attrs:{type:"number",min:"0"},on:{change:t.towMice,input:t.change},model:{value:t.searchList.endOrderAmount,callback:function(e){t.$set(t.searchList,"endOrderAmount",e)},expression:"searchList.endOrderAmount"}})],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-right":"0"},attrs:{label:"最后消费时间："}},[s("el-date-picker",{attrs:{type:"datetimerange",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.lastOrderTime,callback:function(e){t.lastOrderTime=e},expression:"lastOrderTime"}})],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-right":"0"},attrs:{label:"所在地区："}},[s("el-input",{staticStyle:{width:"203px"},attrs:{clearable:""},on:{input:t.change},model:{value:t.searchList.address,callback:function(e){t.$set(t.searchList,"address",e)},expression:"searchList.address"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"性别："}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchList.sex,callback:function(e){t.$set(t.searchList,"sex",e)},expression:"searchList.sex"}},[s("el-option",{attrs:{label:"男",value:1}}),t._v(" "),s("el-option",{attrs:{label:"女",value:2}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"客户身份："}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchList.isVip,callback:function(e){t.$set(t.searchList,"isVip",e)},expression:"searchList.isVip"}},[s("el-option",{attrs:{label:"普通客户",value:1}}),t._v(" "),s("el-option",{attrs:{label:"会员",value:2}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"会员状态："}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchList.vipStatus,callback:function(e){t.$set(t.searchList,"vipStatus",e)},expression:"searchList.vipStatus"}},[s("el-option",{attrs:{label:"使用中",value:1}}),t._v(" "),s("el-option",{attrs:{label:"已过期",value:2}}),t._v(" "),s("el-option",{attrs:{label:"已停用",value:3}})],1)],1)],1)],1)]),t._v(" "),s("el-card",{staticClass:"operate-container",staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[s("div",{staticClass:"flex-row-between",staticStyle:{width:"100%"}},[s("div",[s("i",{staticClass:"el-icon-tickets"}),t._v(" "),s("span",[t._v("数据列表")])]),t._v(" "),s("div",[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.exportExcel}},[t._v("导出Excel")])],1)])]),t._v(" "),s("el-card",{staticClass:"filter-container",staticStyle:{"margin-top":"20px"},attrs:{shadow:"never"}},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.list,"tooltip-effect":"dark",fit:"","header-cell-style":{"font-size":"14px"}},on:{"selection-change":t.handleSelectionChange,"sort-change":t.tableSortChange}},[s("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),s("el-table-column",{attrs:{label:"微信昵称",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.nickName?e.row.nickName:"-"))]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"来源",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.sourceType?s("div",[t._v("H5")]):t._e(),t._v(" "),1==e.row.sourceType?s("div",[t._v("小程序")]):t._e(),t._v(" "),2==e.row.sourceType?s("div",[t._v("小程序&H5")]):t._e()]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"手机号",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.cellPhone?e.row.cellPhone:"-"))]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"客户身份",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isVip?s("div",[t._v("普通客户")]):t._e(),t._v(" "),2==e.row.isVip?s("div",[t._v("会员客户")]):t._e()]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"会员状态",width:"200",prop:"vipStatusName"}}),t._v(" "),s("el-table-column",{attrs:{label:"姓名",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.userName?e.row.userName:"-"))]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"orderTotal",label:"累计消费订单数",width:"165",sortable:"orderTotal"},scopedSlots:t._u([{key:"header",fn:function(e){return[t._v("\n          累计消费订单数\n          "),s("el-tooltip",{staticClass:"item",attrs:{"data-type":e.row,effect:"dark",content:"累计消费订单数不包含全部退款的订单",placement:"top"}},[s("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"orderAmount",label:"累计消费金额",width:"165",sortable:"orderAmount"},scopedSlots:t._u([{key:"header",fn:function(e){return[t._v("\n          累计消费金额\n          "),s("el-tooltip",{staticClass:"item",attrs:{"data-type":e.row,effect:"dark",width:"165",content:"累计消费金额不包含退款金额",placement:"top"}},[s("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"最后消费时间",sortable:"firstOrderTime",width:"190"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.firstTime?e.row.firstTime:"-"))]}}])}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){t.itemInfo(e.row.id)}}},[t._v("查看")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){t.sendItem(e.row)}}},[t._v("送会员")]),t._v(" "),2==e.row.isVip?s("el-button",{staticClass:"dangerFont",attrs:{type:"text",size:"small"},on:{click:function(s){t.stopItem(e.row)}}},[t._v("停用")]):t._e()]}}])})],1),t._v(" "),s("div",{staticClass:"flex-row-between",staticStyle:{"padding-top":"20px"}},[s("div",{staticClass:"flex-row-start"},[s("el-button",{staticStyle:{"margin-right":"10px"},on:{click:t.sendAll}},[t._v("批量送会员")])],1),t._v(" "),s("div",[s("el-pagination",{attrs:{"page-sizes":[5,10,15,20],"page-size":t.searchList.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1),t._v(" "),s("el-dialog",{attrs:{title:"送会员",visible:t.vipShow,width:"50%"},on:{"update:visible":function(e){t.vipShow=e}}},[s("div",{staticClass:"flex-row-center"},[s("div",{staticStyle:{"margin-right":"4px"}},[t._v("赠送")]),t._v(" "),s("el-input-number",{staticStyle:{"margin-right":"4px"},attrs:{min:1,"step-strictly":"",controls:!1},model:{value:t.vipForm.numberTime,callback:function(e){t.$set(t.vipForm,"numberTime",e)},expression:"vipForm.numberTime"}}),t._v(" "),s("el-select",{staticStyle:{"margin-right":"4px"},attrs:{placeholder:"请选择"},model:{value:t.vipForm.unit,callback:function(e){t.$set(t.vipForm,"unit",e)},expression:"vipForm.unit"}},[s("el-option",{attrs:{label:"天",value:"D"}}),t._v(" "),s("el-option",{attrs:{label:"月",value:"M"}})],1),t._v(" "),s("div",[t._v("会员？")])],1),t._v(" "),s("div",{staticClass:"mt10 tac dangerFont"},[t._v("赠送后将无法收回，请谨慎操作！")]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.vipShow=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.send}},[t._v("确 定")])],1)])],1)},[],!1,null,null,null);c.options.__file="customerManage.vue";e.default=c.exports}}]);
//# sourceMappingURL=chunk-c760.22266ac5.js.map