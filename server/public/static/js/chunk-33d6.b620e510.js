(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-33d6","WFwG"],{"34+2":function(t,e,s){},"4jk9":function(t,e,s){},"8/xu":function(t,e,s){"use strict";var i=s("4jk9");s.n(i).a},DKYH:function(t,e,s){"use strict";s.d(e,"f",function(){return a}),s.d(e,"j",function(){return o}),s.d(e,"b",function(){return l}),s.d(e,"d",function(){return r}),s.d(e,"g",function(){return n}),s.d(e,"h",function(){return c}),s.d(e,"a",function(){return u}),s.d(e,"c",function(){return g}),s.d(e,"i",function(){return d}),s.d(e,"e",function(){return m});var i=s("t3Un");function a(t){return Object(i.a)({url:"/sys/business/shopInfo/getShopConfigInfo?shopId="+t,method:"get"})}function o(t){return Object(i.a)({url:"/sys/business/shopInfo/updateShopConfigInfo",method:"post",data:t})}function l(){return Object(i.a)({url:"/product/business/freightTemplate/getFreightSystemDistrictInfo",method:"get"})}function r(t){return Object(i.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoList",method:"post",data:t})}function n(t){return Object(i.a)({url:"/product/business/freightTemplate/insertFreightTemplateInfo",method:"post",data:t})}function c(t){return Object(i.a)({url:"/product/business/freightTemplate/updateDefault",method:"post",data:t})}function u(t){return Object(i.a)({url:"/product/business/freightTemplate/deleteFreightTemplateInfo",method:"post",data:t})}function g(t){return Object(i.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoById?templateId="+t,method:"get"})}function d(t){return Object(i.a)({url:"/product/business/freightTemplate/updateFreightTemplateInfo",method:"post",data:t})}function m(t){return Object(i.a)({url:"/product/business/freightTemplate/getFreightTemplateInfoListNotPage?shopId="+t,method:"get"})}},FqQn:function(t,e,s){"use strict";s.d(e,"a",function(){return a}),s.d(e,"b",function(){return o});var i=s("t3Un");function a(t){return Object(i.a)({url:"/product/business/product/insertProduct",method:"post",data:t})}function o(t,e){return Object(i.a)({url:"/product/business/product/isExistProductCode?productCode="+e+"&shopId="+t,method:"get"})}},IneS:function(t,e,s){t.exports=s.p+"static/img/goodShare1.88b59b5.png"},"Og+O":function(t,e,s){"use strict";var i=s("QbLZ"),a=s.n(i),o=s("L2JU"),l=s("WFwG"),r={props:["getPost","limitType","multiple","totalNum","selectNum"],watch:{getPost:function(t,e){t&&(console.log("执行了"),this.selectImgArr=[],this.getGaller())}},data:function(){return{imageClassTags:[],getGalleryForm:{},getImgsForm:{pageSize:30,pageNum:1},imgs:[],imgsTotal:0,selectImgs:[],uploadImg:!1,uploadImgLoading:!1,uploadImgForm:{galleryId:0,galleryList:[{}]},videoForm:{imageUrl:""},videoImg:"",galleryList:[{imageUrl:""}],activeClassName:"",updateClassArr:[],ImageBoxHeight:0,OperationHeight:0,srcList:[],action:"",imgaction:"",videoFlag:!1,videoUploadPercent:"",isShowUploadVideo:!1,selectImgArr:[]}},created:function(){this.getGalleryForm.shopId=this.shop.shopId,this.getGalleryForm.type=2,this.getImgsForm.shopId=this.shop.shopId,this.getImgsForm.type=2,this.action="/product/business/gallery/uploadGalleryVideo?shopId="+this.shop.shopId,this.imgaction="/product/business/gallery/uploadGalleryImage?shopId="+this.shop.shopId,this.getGaller()},mounted:function(){var t=this;this.$nextTick(function(){this.OperationHeight=window.innerHeight-282,this.ImageBoxHeight=window.innerHeight-400}),window.onresize=function(){return t.OperationHeight=window.innerHeight-282,void(t.ImageBoxHeight=window.innerHeight-400)}},methods:{onlyClose:function(){this.$emit("onlyclose",!0)},subMit:function(){console.log("this.selectImgArr",this.selectImgArr),0!=this.selectImgArr.length?this.$emit("subMit",this.selectImgArr):this.$message.error("请先选择视频")},clickItem:function(t){if(-1===this.selectImgArr.findIndex(function(e){return e.id==t.id})){if(this.limitType&&this.totalNum-this.selectNum-this.selectImgArr.length<=0)return void this.$message.error("已超过添加最大视频数量");this.selectImgArr.push(t)}else this.selectImgArr.splice(this.selectImgArr.findIndex(function(e){return e.id===t.id}),1)},showPos:function(t){return-1!==this.selectImgArr.findIndex(function(e){return e.id==t.id})},showNum:function(t){return this.selectImgArr.findIndex(function(e){return e.id==t.id})+1},beforeAvatarUpload:function(t){console.log("file",t);var e="image/jpeg"===t.type||"image/gif"===t.type||"image/png"===t.type||"image/bmp"===t.type;console.log(e);var s=t.size/1024/1024<3;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&s},imgUp:function(t,e){console.log("上传封面",t,e),this.videoImg=t.data[0].name},handleExceed:function(t,e){this.$message.warning("单次最多上传1张图片，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},beforeUploadVideo:function(t){console.log("上传前",t);var e=t.size/1024/1024<20;return-1==["video/mp4","video/mov","video/m4v","video/flv","video/x-flv","video/mkv","video/wmv","video/avi","video/rmvb","video/3gp"].indexOf(t.type)?(this.$message.error("请上传正确的视频格式"),!1):e?void(this.isShowUploadVideo=!1):(this.$message.error("视频大小不能超过20MB"),!1)},uploadVideoProcess:function(t,e,s){console.log("进度条",t,e,s),this.videoFlag=!0,this.videoUploadPercent=1*e.percentage.toFixed(0)},handleVideoSuccess:function(t,e){if(console.log("上传成功",t,e),this.isShowUploadVideo=!0,this.videoFlag=!1,this.videoUploadPercent=0,200==t.code){console.log("this.uploadImgForm.galleryList",this.uploadImgForm.galleryList,""==this.uploadImgForm.galleryList[0].coversUrl);var s=[],i={imageUrl:t.data[0].name,duration:t.data[0].duration,imageSize:t.data[0].size};this.videoImg||(this.videoImg=t.data[0].coversUrl),console.log("obj",i),s.push(i),this.galleryList=s}else this.$message.error(t.Message)},getImgs:function(){var t=this;Object(l.g)(this.getImgsForm).then(function(e){console.log("获取分类下图片",e);var s=e.data.list;s.forEach(function(t){return t.checked=!1}),t.imgs=s,t.imgsTotal=e.data.total})},showBigImg:function(t){this.videoPlayShow=!0,this.videoPlay.imageUrl=t},uploadImgFun:function(){var t=this;console.log("this.uploadImgForm",this.uploadImgForm),this.galleryList[0].imageUrl?this.uploadImgForm.imageName?(this.galleryList[0].imageName=this.uploadImgForm.imageName,this.galleryList[0].coversUrl=this.videoImg,this.uploadImgForm.galleryList=this.galleryList,this.uploadImgForm.type=2,this.uploadImgForm.shopId=this.shop.shopId,this.uploadImgLoading=!0,console.log("请求上传的接口",this.uploadImgForm),this.selectImgArr=this.galleryList,Object(l.a)(this.uploadImgForm).then(function(e){console.log("上传视频保存",e),200==e.code?(t.$message({message:"恭喜，上传成功",type:"success"}),t.getGaller(),t.uploadImgForm.galleryId=0,t.uploadImgForm.imageName="",t.uploadImgForm.coversUrl="",t.videoImg="",t.subMit(),t.galleryList=[{imageUrl:""}],t.uploadImg=!1,setTimeout(function(){t.uploadImgLoading=!1},1e3)):(t.uploadImgLoading=!1,t.$message.error(e.message))})):this.$message.error("请为视频命名"):this.$message.error("请先上传视频")},getGaller:function(){var t=this;console.log("请求分类的数据",this.getGalleryForm),Object(l.f)(this.getGalleryForm).then(function(e){console.log("获取视频库分组",e);var s=e.data;if(s.forEach(function(t){t.type="info"}),""==t.activeClassName)t.activeClassName=s[0].galleryName,s[0].type="",t.getImgsForm.galleryId=s[0].id;else{var i=s.findIndex(function(e){return e.galleryName==t.activeClassName});console.log("index",i),s[i].type="",t.getImgsForm.galleryId=s[i].id}for(var a=[],o=1;o<s.length;o++)a.push(s[o]);t.updateClassArr=a,t.changeClassArr=a,console.log("arr",a),t.getImgs(),t.imageClassTags=s})},activeClass:function(t){console.log("点击了分组按钮"),this.imageClassTags.forEach(function(t){return t.type="info"}),t.type="",this.selectImgs=[],this.allChecked=!1,this.getImgsForm.galleryId=t.id,this.activeClassName=t.galleryName,this.getImgsForm.imageName="",this.getImgs()},handleSizeChange:function(t){this.getImgsForm.pageSize=t,this.getImgs()},handleCurrentChange:function(t){this.getImgsForm.pageNum=t,this.getImgs()},change:function(t){this.$forceUpdate()}},computed:a()({},Object(o.c)(["user","shop"]))},n=(s("hjWo"),s("vnAM"),s("KHd+")),c=Object(n.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"box"},[s("div",{staticClass:"flex-row-start"},[s("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("div",{staticClass:"materinalOperation"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"search",staticStyle:{"margin-bottom":"20px"}},[s("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索分组"},model:{value:t.getGalleryForm.galleryName,callback:function(e){t.$set(t.getGalleryForm,"galleryName",e)},expression:"getGalleryForm.galleryName"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getGaller},slot:"append"})],1)],1),t._v(" "),s("div",{staticClass:"class flex-column-center"},[s("div",{staticClass:"classList",style:{height:t.OperationHeight+"px"},attrs:{height:t.OperationHeight+"px"}},[s("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto",height:"100%"}},t._l(t.imageClassTags,function(e){return s("li",{key:e.name,staticClass:"li infinite-list-item",on:{click:function(s){t.activeClass(e)}}},[0==e.id||-1==e.id?s("el-tag",{staticStyle:{width:"100%"},attrs:{type:e.type}},[t._v(t._s(e.galleryName)+" "+t._s(-1===e.id?"":"( "+e.totalAmount+" )"))]):t._e()],1)}))])])])],1)]),t._v(" "),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"materinalContent"},[s("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[s("h3",{staticStyle:{"margin-bottom":"20px"}},[t._v(t._s(t.activeClassName))]),t._v(" "),s("div",{staticClass:"flex-row-between"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.uploadImg=!0}}},[t._v("上传视频")]),t._v(" "),s("div",{staticClass:"search"},[s("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索视频"},model:{value:t.getImgsForm.imageName,callback:function(e){t.$set(t.getImgsForm,"imageName",e)},expression:"getImgsForm.imageName"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getImgs},slot:"append"})],1)],1)],1)]),t._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.imgs.length>0,expression:"imgs.length > 0"}]},[s("div",{staticClass:"classList",style:{height:t.ImageBoxHeight+"px"}},[s("ul",{staticClass:"infinite-list flex-row-start1 ul",staticStyle:{"overflow-x":"hidden","overflow-y":"auto",height:"100%"}},t._l(t.imgs,function(e,i){return s("li",{key:i,staticClass:"infinite-list-item item",on:{click:function(s){t.clickItem(e,i)}}},[s("div",{staticClass:"demo-image__preview"},[s("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{fit:"fill",src:e.coversUrl}}),t._v(" "),s("div",{staticClass:"imgNameBox"},[t._v(t._s(e.imageName))]),t._v(" "),s("div",{staticStyle:{"text-align":"center",color:"#909399"}},[t._v(t._s(e.duration))])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPos(e),expression:"showPos(item)"}],staticClass:"pos"},[t._v(t._s(t.showNum(e)))])])}))]),t._v(" "),s("div",{staticClass:"fy flex-row-end"},[s("div",[s("el-pagination",{attrs:{"page-sizes":[10,20,30],"page-size":t.getImgsForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.imgsTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.imgs.length,expression:"imgs.length == 0"}]},[t._v("暂无视频，可以点击左上角“上传视频”按钮添加")])])],1)])],1)],1),t._v(" "),s("div",{staticClass:"flex-row-between",staticStyle:{"margin-top":"10px"}},[t.limitType?s("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 条，还可以选择 "+t._s(t.totalNum-t.selectNum-t.selectImgArr.length)+" 条")]):s("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 条")]),t._v(" "),s("div",[s("el-button",{on:{click:t.onlyClose}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.subMit}},[t._v("确 定")])],1)])]),t._v(" "),s("el-dialog",{attrs:{title:"上传视频",visible:t.uploadImg,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,"modal-append-to-body":!1,width:"70%"},on:{"update:visible":function(e){t.uploadImg=e}}},[s("el-form",{ref:"upload",staticClass:"demo-ruleForm",attrs:{model:t.uploadImgForm,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"本地视频"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.action,name:"files","on-progress":t.uploadVideoProcess,"on-success":t.handleVideoSuccess,"before-upload":t.beforeUploadVideo,"show-file-list":!1}},[""==t.galleryList[0].imageUrl||t.videoFlag?t._e():s("video",{staticClass:"avatar video-avatar",staticStyle:{width:"300px",height:"200px"},attrs:{src:t.galleryList[0].imageUrl,controls:"controls"}},[t._v("\n            您的浏览器不支持视频播放\n          ")]),t._v(" "),""!=t.galleryList[0].imageUrl||t.videoFlag?t._e():s("el-button",{attrs:{type:"primary"}},[t._v("添加视频")]),t._v(" "),1==t.videoFlag?s("el-progress",{staticStyle:{"margin-top":"7px"},attrs:{type:"circle",percentage:t.videoUploadPercent}}):t._e()],1),t._v(" "),s("div",[t._v("视频不能超过20M，支持mp4，mov，m4v，flv,x-flv，mkv，wmv，avi，rmvb，3gp视频格式")])],1),t._v(" "),s("el-form-item",{attrs:{label:"视频标题"}},[s("el-input",{staticStyle:{width:"400px"},attrs:{type:"text",placeholder:"请输入内容",maxlength:"15","show-word-limit":""},model:{value:t.uploadImgForm.imageName,callback:function(e){t.$set(t.uploadImgForm,"imageName",e)},expression:"uploadImgForm.imageName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"视频封面"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.imgaction,"show-file-list":!1,"on-success":t.imgUp,name:"files","before-upload":t.beforeAvatarUpload}},[t.videoImg?s("img",{staticClass:"avatar",staticStyle:{width:"150px",height:"150px"},attrs:{src:t.videoImg}}):s("el-button",{attrs:{type:"primary"}},[t._v("修改封面")])],1),t._v(" "),s("div",[t._v("默认视频第一帧为封面")])],1),t._v(" "),s("el-form-item",{attrs:{label:"选择分组"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadImgForm.galleryId,callback:function(e){t.$set(t.uploadImgForm,"galleryId",e)},expression:"uploadImgForm.galleryId"}},t._l(t.updateClassArr,function(t){return s("el-option",{key:t.name,attrs:{label:t.galleryName,value:t.id}})}))],1),t._v(" "),s("el-form-item",{staticStyle:{"text-align":"center"}},[s("el-button",{on:{click:function(e){t.uploadImg=!1}}},[t._v("关 闭")]),t._v(" "),s("el-button",{attrs:{loading:t.uploadImgLoading,type:"primary"},on:{click:t.uploadImgFun}},[t._v("确 定")])],1)],1)],1)],1)},[],!1,null,"cde7948c",null);c.options.__file="videoMaterial.vue";e.a=c.exports},PRgn:function(t,e,s){"use strict";s.d(e,"b",function(){return a}),s.d(e,"e",function(){return o}),s.d(e,"a",function(){return l}),s.d(e,"f",function(){return r}),s.d(e,"h",function(){return n}),s.d(e,"g",function(){return c}),s.d(e,"d",function(){return u}),s.d(e,"c",function(){return g});var i=s("t3Un");function a(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryInfoList",method:"post",data:t})}function o(t){return Object(i.a)({url:"/product/business/productCategoryShop/insertProductCategoryShop",method:"post",data:t})}function l(t){return Object(i.a)({url:"/product/business/productCategoryShop/deleteProductCategoryShop",method:"post",data:t})}function r(t){return Object(i.a)({url:"/product/business/productCategoryShop/isCategoryNameExist?name="+t.name+"&level="+t.level+"&shopId="+t.shopId+"&parentId="+t.parentId,method:"get"})}function n(t){return Object(i.a)({url:"/product/business/productCategoryShop/updateProductCategoryShopOrderNo",method:"post",data:t})}function c(t){return Object(i.a)({url:"/product/business/productCategoryShop/updateProductCategoryShop",method:"post",data:t})}function u(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryShopAllList?shopId="+t,method:"get"})}function g(t){return Object(i.a)({url:"/product/business/productCategoryShop/getProductCategoryInfoPageList",method:"post",data:t})}},PgIU:function(t,e,s){"use strict";s.d(e,"g",function(){return a}),s.d(e,"e",function(){return o}),s.d(e,"f",function(){return l}),s.d(e,"a",function(){return r}),s.d(e,"b",function(){return n}),s.d(e,"d",function(){return c}),s.d(e,"c",function(){return u});var i=s("t3Un");function a(t){return Object(i.a)({url:"/sys/shopSelffetch/shopSelffetchPage",method:"post",data:t})}function o(t){return Object(i.a)({url:"/sys/shopSelffetch/getShopSelffetch?shopId="+t,method:"get"})}function l(t,e){return Object(i.a)({url:"/sys/shopSelffetch/setShopSelffetch?shopId="+t+"&selffedchStatus="+e,method:"get"})}function r(t){return Object(i.a)({url:"/sys/shopSelffetch/addShopSelffetch",method:"post",data:t})}function n(t,e){return Object(i.a)({url:"/sys/shopSelffetch/deleteShopSelffetch?selffetchId="+t+"&shopId="+e,method:"delete"})}function c(t){return Object(i.a)({url:"/sys/shopSelffetch/findShopSelffetchById?selffetchId="+t,method:"get"})}function u(t){return Object(i.a)({url:"/sys/shopSelffetch/editShopSelffetch",method:"post",data:t})}},U7fH:function(t,e,s){"use strict";var i=s("ZB0S");s.n(i).a},WFwG:function(t,e,s){"use strict";s.d(e,"f",function(){return a}),s.d(e,"h",function(){return o}),s.d(e,"l",function(){return l}),s.d(e,"b",function(){return r}),s.d(e,"g",function(){return n}),s.d(e,"d",function(){return c}),s.d(e,"a",function(){return u}),s.d(e,"k",function(){return g}),s.d(e,"j",function(){return d}),s.d(e,"c",function(){return m}),s.d(e,"e",function(){return h}),s.d(e,"i",function(){return p});var i=s("t3Un");function a(t){return Object(i.a)({url:"/product/business/gallery/getGalleryByShopId?shopId="+t.shopId+"&galleryName="+(t.galleryName?t.galleryName:"")+"&type="+t.type,method:"get"})}function o(t){return Object(i.a)({url:"/product/business/gallery/insertGallery",method:"post",data:t})}function l(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryName",method:"post",data:t})}function r(t){return Object(i.a)({url:"/product/business/gallery/deleteGallery",method:"post",data:t})}function n(t){return Object(i.a)({url:"/product/business/gallery/getGalleryImageByGroup",method:"post",data:t})}function c(t){return Object(i.a)({url:"/product/business/gallery/deleteOssFile",method:"post",data:t})}function u(t){return Object(i.a)({url:"/product/business/gallery/addGalleryImage",method:"post",data:t})}function g(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryImageName",method:"post",data:t})}function d(t){return Object(i.a)({url:"/product/business/gallery/updateGalleryImageGroup",method:"post",data:t})}function m(t){return Object(i.a)({url:"/product/business/gallery/deleteGalleryImage",method:"post",data:t})}function h(t){return Object(i.a)({url:"/product/business/gallery/getDeleteGallery",method:"post",data:t})}function p(t){return Object(i.a)({url:"/product/business/gallery/updateDeleteStatus",method:"post",data:t})}},ZB0S:function(t,e,s){},hjWo:function(t,e,s){"use strict";var i=s("jdaY");s.n(i).a},"jM9+":function(t,e,s){"use strict";var i=s("ri7H");s.n(i).a},jdaY:function(t,e,s){},mtBR:function(t,e,s){t.exports=s.p+"static/img/goodShare2.4b94591.png"},pgPq:function(t,e,s){"use strict";var i=s("QbLZ"),a=s.n(i),o=s("L2JU"),l=s("WFwG"),r={props:["getPost","limitType","multiple","totalNum","selectNum"],watch:{getPost:function(t,e){t&&(console.log("执行了"),this.selectImgArr=[],this.getGaller(),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0)}},data:function(){return{selectImgArr:[],hideUpload:!1,imageClassTags:[],getGalleryForm:{},getImgsForm:{pageSize:30,pageNum:1},imgs:[],imgsTotal:0,uploadImg:!1,uploadImgLoading:!1,uploadImgForm:{galleryId:0},galleryList:[],activeClassName:"",updateClassArr:[],ImageBoxHeight:0,OperationHeight:0,action:""}},created:function(){console.log("图片库created的multiple",this.multiple),console.log("图片库created的totalNum",this.totalNum),console.log("图片库created的selectNum",this.selectNum),this.getGalleryForm.shopId=this.shop.shopId,this.getGalleryForm.type=1,this.getImgsForm.shopId=this.shop.shopId,this.getImgsForm.type=1,this.action="/product/business/gallery/uploadGalleryImage?shopId="+this.shop.shopId,this.getGaller()},mounted:function(){var t=this;console.log("执行了mounted"),this.$nextTick(function(){this.OperationHeight=window.innerHeight-282,this.ImageBoxHeight=window.innerHeight-400}),window.onresize=function(){return t.OperationHeight=window.innerHeight-282,void(t.ImageBoxHeight=window.innerHeight-400)}},methods:{showPos:function(t){return-1!==this.selectImgArr.findIndex(function(e){return e.id==t.id})},showNum:function(t){return this.selectImgArr.findIndex(function(e){return e.id==t.id})+1},clickItem:function(t){if(-1===this.selectImgArr.findIndex(function(e){return e.id==t.id})){if(this.limitType&&this.totalNum-this.selectNum-this.selectImgArr.length<=0)return void this.$message.error("已超过添加最大图片数量");this.selectImgArr.push(t)}else this.selectImgArr.splice(this.selectImgArr.findIndex(function(e){return e.id===t.id}),1)},onlyClose:function(){this.$emit("onlyclose",!0)},subMit:function(){console.log("this.selectImgArr",this.selectImgArr),0!=this.selectImgArr.length?this.$emit("subMit",this.selectImgArr):this.$message.error("请先选择图片")},getImgs:function(){var t=this;Object(l.g)(this.getImgsForm).then(function(e){console.log("获取分类下图片",e);var s=e.data.list;s.forEach(function(t){return t.checked=!1}),t.imgs=s,t.imgsTotal=e.data.total})},imgUp:function(t,e){console.log(t,e);var s={};s.imageName=t.data[0].orginName,s.imageSize=t.data[0].size,s.imageUrl=t.data[0].name,s.width=t.data[0].width,s.height=t.data[0].height,this.galleryList.push(s),this.selectImgArr.push(s),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0},imgRemove:function(t,e){var s=this;if(console.log("图片删除",t,e),t.response){var i={},a=[],o={};o.imageUrl=t.response.data[0].name,a.push(o),i.shopId=this.shop.shopId,i.type=1,i.galleryList=a,this.deleteImgFun(i),this.galleryList=[],e.forEach(function(t){var e={};e.imageName=t.response.data[0].orginName,e.imageSize=t.response.data[0].size,e.imageUrl=t.response.data[0].name,e.width=t.response.data[0].width,e.height=t.response.data[0].height,s.galleryList.push(e)});var l=t.response.data[0].uid;this.selectImgArr.splice(this.selectImgArr.findIndex(function(t){return(t.uid&&t.uid)===l}),1),this.hideUpload=this.totalNum-this.selectNum-this.selectImgArr.length==0,console.log("删除后的已选择",this.selectImgArr)}},deleteImgFun:function(t){Object(l.d)(t).then(function(t){console.log("删除oss资源",t)})},uploadImgFun:function(){var t=this;this.uploadImgForm.type=1,this.uploadImgForm.shopId=this.shop.shopId,0!=this.galleryList.length?(this.uploadImgLoading=!0,this.uploadImgForm.galleryList=this.galleryList,Object(l.a)(this.uploadImgForm).then(function(e){console.log("上传图片保存",e),200==e.code?(t.$message({message:"恭喜，上传成功",type:"success"}),t.uploadImg=!1,t.uploadImgForm.galleryId=0,t.galleryList=[],t.$refs.upload.clearFiles(),t.subMit(),setTimeout(function(){t.uploadImgLoading=!1},1e3)):(t.uploadImgLoading=!1,t.$message.error(e.message))})):this.$message.error("请先上传图片")},showUploadImg:function(){this.limitType&&this.totalNum-this.selectNum-this.selectImgArr.length<=0?this.$message.error("已超过添加最大图片数量"):this.uploadImg=!0},uploadImgClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(s){console.log("执行了",e.galleryList);var i={},a=[];e.galleryList.forEach(function(t){var e={};e.imageUrl=t.imageUrl,a.push(e)}),i.shopId=e.shop.shopId,i.type=1,i.galleryList=a,e.galleryList=[],e.$refs.upload.clearFiles(),e.deleteImgFun(i),t()}).catch(function(t){})},handleExceed:function(t,e){this.$message.warning("单次最多上传"+(this.totalNum-this.selectNum-this.selectImgArr.length)+"张图片，共选择了 "+(t.length+e.length)+" 个文件")},beforeAvatarUpload:function(t){console.log("file",t);var e="image/jpeg"===t.type||"image/gif"===t.type||"image/png"===t.type||"image/bmp"===t.type;console.log(e);var s=t.size/1024/1024<3;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&s},getGaller:function(){var t=this;console.log("请求分类的数据",this.getGalleryForm),Object(l.f)(this.getGalleryForm).then(function(e){console.log("获取图片库分组",e);var s=e.data;if(s.forEach(function(t){t.type="info"}),""==t.activeClassName)t.activeClassName=s[0].galleryName,s[0].type="",t.getImgsForm.galleryId=s[0].id;else{var i=s.findIndex(function(e){return e.galleryName==t.activeClassName});s[i].type="",t.getImgsForm.galleryId=s[i].id}for(var a=[],o=1;o<s.length;o++)a.push(s[o]);t.updateClassArr=a,t.changeClassArr=a,console.log("arr",a),t.getImgs(),t.imageClassTags=s})},activeClass:function(t){console.log("点击了分组按钮"),this.imageClassTags.forEach(function(t){return t.type="info"}),t.type="",this.allChecked=!1,this.getImgsForm.galleryId=t.id,this.activeClassName=t.galleryName,this.getImgs()},handleSizeChange:function(t){this.getImgsForm.pageSize=t,this.getImgs()},handleCurrentChange:function(t){this.getImgsForm.pageNum=t,this.getImgs()},change:function(t){this.$forceUpdate()}},computed:a()({},Object(o.c)(["user","shop"]))},n=(s("jM9+"),s("U7fH"),s("8/xu"),s("KHd+")),c=Object(n.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"box"},[s("div",{staticClass:"flex-row-start"},[s("el-row",{staticStyle:{width:"100%"},attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("div",{staticClass:"materinalOperation"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"search",staticStyle:{"margin-bottom":"20px"}},[s("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索分组"},model:{value:t.getGalleryForm.galleryName,callback:function(e){t.$set(t.getGalleryForm,"galleryName",e)},expression:"getGalleryForm.galleryName"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getGaller},slot:"append"})],1)],1),t._v(" "),s("div",{staticClass:"class flex-column-center"},[s("div",{staticClass:"classList",style:{height:t.OperationHeight+"px"},attrs:{height:t.OperationHeight+"px"}},[s("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto",height:"100%"}},t._l(t.imageClassTags,function(e){return s("li",{key:e.name,staticClass:"li infinite-list-item",on:{click:function(s){t.activeClass(e)}}},[s("el-tag",{staticStyle:{width:"100%"},attrs:{type:e.type}},[t._v(t._s(e.galleryName)+" "+t._s(-1===e.id?"":"( "+e.totalAmount+" )"))])],1)}))])])])],1)]),t._v(" "),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"materinalContent"},[s("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[s("h3",{staticStyle:{"margin-bottom":"20px"}},[t._v(t._s(t.activeClassName))]),t._v(" "),s("div",{staticClass:"flex-row-between"},[s("el-button",{attrs:{type:"primary"},on:{click:t.showUploadImg}},[t._v("上传图片")]),t._v(" "),s("div",{staticClass:"search"},[s("el-input",{staticClass:"input-with-select searchInput",attrs:{placeholder:"搜索图片"},model:{value:t.getImgsForm.imageName,callback:function(e){t.$set(t.getImgsForm,"imageName",e)},expression:"getImgsForm.imageName"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getImgs},slot:"append"})],1)],1)],1)]),t._v(" "),s("el-card",{staticClass:"box-card"},[t.imgs.length>0?s("div",[s("div",{staticClass:"classList",style:{height:t.ImageBoxHeight+"px"}},[s("ul",{staticClass:"infinite-list flex-row-start1 ul",staticStyle:{"overflow-x":"hidden","overflow-y":"auto",height:"100%"}},t._l(t.imgs,function(e,i){return s("li",{key:i,staticClass:"infinite-list-item item",on:{click:function(s){t.clickItem(e,i)}}},[s("div",{staticClass:"demo-image__preview"},[s("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{fit:"fill",src:e.imageUrl}}),t._v(" "),s("div",{staticClass:"imgNameBox"},[t._v(t._s(e.imageName))]),t._v(" "),s("div",{staticStyle:{"text-align":"center",color:"#909399"}},[t._v(t._s(e.width+" x "+e.height))])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPos(e),expression:"showPos(item)"}],staticClass:"pos"},[t._v(t._s(t.showNum(e)))])])}))]),t._v(" "),s("div",{staticClass:"fy flex-row-end"},[s("div",[s("el-pagination",{attrs:{"page-sizes":[10,20,30],"page-size":t.getImgsForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.imgsTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]):s("div",[t._v("暂无图片，可以点击左上角“上传图片”按钮添加")])])],1)])],1)],1),t._v(" "),s("div",{staticClass:"flex-row-between",staticStyle:{"margin-top":"10px"}},[t.limitType?s("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 张，还可以选择 "+t._s(t.totalNum-t.selectNum-t.selectImgArr.length)+" 张")]):s("div",[t._v("已选 "+t._s(t.selectNum+t.selectImgArr.length)+" 张")]),t._v(" "),s("div",[s("el-button",{on:{click:t.onlyClose}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.subMit}},[t._v("确 定")])],1)])]),t._v(" "),s("el-dialog",{attrs:{title:"上传图片",visible:t.uploadImg,"before-close":t.uploadImgClose,"modal-append-to-body":!1,width:"65%"},on:{"update:visible":function(e){t.uploadImg=e}}},[s("el-form",{ref:"editGalleryForm",staticClass:"demo-ruleForm",attrs:{model:t.uploadImgForm,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"本地图片"}},[s("el-upload",{ref:"upload",class:{hide:t.hideUpload},attrs:{action:t.action,name:"files",multiple:t.multiple,"list-type":"picture-card","on-success":t.imgUp,"on-remove":t.imgRemove,"on-exceed":t.handleExceed,limit:t.limitType?t.totalNum-t.selectNum-t.selectImgArr.length:9999,"before-upload":t.beforeAvatarUpload}},[s("i",{staticClass:"el-icon-plus"}),t._v(" "),t.limitType?s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("单次最多上传"+t._s(this.totalNum-this.selectNum-this.selectImgArr.length)+"张图片，仅支持 gif、 jpeg、 png、 bmp 4种格式, 大小不超过3.0 MB")]):s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("仅支持 gif、 jpeg、 png、 bmp 4种格式, 大小不超过3.0 MB")])])],1),t._v(" "),s("el-form-item",{attrs:{label:"选择分组"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadImgForm.galleryId,callback:function(e){t.$set(t.uploadImgForm,"galleryId",e)},expression:"uploadImgForm.galleryId"}},t._l(t.updateClassArr,function(t){return s("el-option",{key:t.name,attrs:{label:t.galleryName,value:t.id}})}))],1),t._v(" "),s("el-form-item",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{loading:t.uploadImgLoading,type:"primary"},on:{click:t.uploadImgFun}},[t._v("确 定")])],1)],1)],1)],1)},[],!1,null,"3039c789",null);c.options.__file="imageMaterial.vue";e.a=c.exports},ri7H:function(t,e,s){},vnAM:function(t,e,s){"use strict";var i=s("34+2");s.n(i).a}}]);
//# sourceMappingURL=chunk-33d6.b620e510.js.map